{"version":3,"sources":["webpack://belter/webpack/universalModuleDefinition","webpack://belter/webpack/bootstrap","webpack://belter/../zalgo-promise/index.js","webpack://belter/../cross-domain-safe-weakmap/index.js","webpack://belter/../zalgo-promise/dist/zalgo-promise.js","webpack://belter/../cross-domain-safe-weakmap/dist/cross-domain-safe-weakmap.js","webpack://belter/./src/screenHeights.ts","webpack://belter/./src/device.ts","webpack://belter/../grumbler-scripts/node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://belter/../grumbler-scripts/node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://belter/../grumbler-scripts/node_modules/@babel/runtime/helpers/esm/extends.js","webpack://belter/../cross-domain-utils/dist/module/utils.js","webpack://belter/../cross-domain-utils/dist/module/constants.js","webpack://belter/../cross-domain-utils/dist/module/types.js","webpack://belter/../grumbler-scripts/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js","webpack://belter/../grumbler-scripts/node_modules/@babel/runtime/helpers/esm/isNativeReflectConstruct.js","webpack://belter/../grumbler-scripts/node_modules/@babel/runtime/helpers/esm/construct.js","webpack://belter/../grumbler-scripts/node_modules/@babel/runtime/helpers/esm/wrapNativeSuper.js","webpack://belter/../grumbler-scripts/node_modules/@babel/runtime/helpers/esm/isNativeFunction.js","webpack://belter/../cross-domain-safe-weakmap/src/util.ts","webpack://belter/../cross-domain-safe-weakmap/src/weakmap.ts","webpack://belter/./src/util.ts","webpack://belter/../cross-domain-safe-weakmap/src/native.ts","webpack://belter/../grumbler-scripts/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js","webpack://belter/./src/constants.ts","webpack://belter/./src/dom.ts","webpack://belter/./src/storage.ts","webpack://belter/./src/experiment.ts","webpack://belter/./src/global.ts","webpack://belter/./src/http.ts","webpack://belter/./src/types.ts","webpack://belter/./src/decorators.ts","webpack://belter/./src/css.ts","webpack://belter/./src/test.ts"],"names":["root","factory","exports","module","define","amd","self","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","hasOwnProperty","p","s","require","e","default","Promise","window","Window","constructor","toString","then","u","resolve","f","a","resolved","rejected","errorHandled","error","handlers","dispatching","stack","reject","prototype","Error","dispatch","setTimeout","indexOf","push","length","asyncReject","onSuccess","onError","h","promise","catch","finally","try","timeout","clearTimeout","toPromise","TypeError","all","hash","map","onPossiblyUnhandledException","cancel","splice","apply","delay","isPromise","flush","location","protocol","parent","host","mockDomain","closed","message","getOwnPropertyDescriptor","mockclosed","top","contentWindow","parentNode","ownerDocument","documentElement","contains","__cross_domain_utils_window_check__","weakmap","keys","values","Math","random","WeakMap","freeze","set","_cleanupClosedWindows","delete","isSafeToReadWrite","writable","has","getOrSet","iPhoneScreenHeightMatrix","device","textSizeHeights","zoomHeight","maybeSafari","getUserAgent","navigator","mockUserAgent","userAgent","isDevice","match","isWebView","test","isStandAlone","standalone","matchMedia","matches","isFacebookWebView","ua","isFirefox","isFirefoxIOS","isEdgeIOS","isOperaMini","isAndroid","isIos","isGoogleSearchApp","isQQBrowser","isIosWebview","isSFVC","outerHeight","height","innerHeight","scale","round","screen","width","innerWidth","computedHeight","isSFVCorSafari","sfvc","possibleSafariSizes","isAndroidWebview","isIE","document","documentMode","Boolean","isIECompHeader","mHttp","querySelector","mContent","isElectron","process","versions","electron","isIEIntranet","status","err","isMacOsCna","supportsPopups","isChrome","isSafari","isApplePaySupported","ApplePaySession","supportsVersion","canMakePayments","_setPrototypeOf","setPrototypeOf","__proto__","_inheritsLoose","subClass","superClass","_extends","assign","target","arguments","source","IE_WIN_ACCESS_ERROR","isAboutProtocol","win","canReadFromWindow","getActualDomain","PROTOCOL","getParent","getDomain","domain","isSameDomain","desc","isActuallySameDomain","iframeWindows","iframeFrames","isWindowClosed","allowMock","iframeIndex","collection","item","safeIndexOf","frame","doc","isFrameWindowClosed","isWindow","obj","_getPrototypeOf","getPrototypeOf","_isNativeReflectConstruct","Reflect","construct","sham","Proxy","Date","_construct","Parent","args","Class","isNativeReflectConstruct","instance","Function","_wrapNativeSuper","_cache","Map","undefined","Wrapper","configurable","objectIDs","CrossDomainSafeWeakMap","testWeakMap","testKey","hasNativeWeakMap","entry","index","getFunctionName","fn","__name__","displayName","setFunctionName","base64encode","str","btoa","encodeURIComponent","replace","p1","String","fromCharCode","parseInt","Buffer","from","base64decode","atob","decodeURIComponent","Array","charCodeAt","slice","join","uniqueID","chars","charAt","floor","toISOString","toLowerCase","getGlobal","global","__GLOBAL__","getObjectID","uid","serializeArgs","JSON","stringify","subkey","val","getEmptyObject","memoizeGlobalIndex","memoizeGlobalIndexValidFrom","memoize","method","options","simpleCache","thisCache","thisNamespace","cacheTime","time","memoizeIndex","memoizedFunction","cache","cacheKey","cacheResult","now","reset","promiseIdentity","ZalgoPromise","memoizePromise","memoizedPromiseFunction","promisify","promisifiedFunction","inlineMemoize","logic","__inline_memoize_cache__","noop","once","called","hashStr","pow","sqrt","strHashStr","total","abs","pattern","regmatch","awaitKey","stringifyError","level","newErr","stringifyErrorMessage","defaultMessage","domainMatches","hostname","split","patchMethod","handler","original","context","callOriginal","extend","result","clear","memoizedValues","perc","pixels","percentage","min","max","roundUp","num","nearest","remainder","regexMap","regexp","results","svgToBase64","svg","objFilter","filter","identity","regexTokenize","text","token","promiseDebounce","localPromise","safeInterval","loop","isInteger","isFloat","serializePrimitive","deserializePrimitive","parseFloat","dotify","prefix","newobj","isArray","every","undotify","keyResult","parts","part","isLast","isIndex","eventEmitter","triggered","emitter","on","eventName","handlerList","cancelled","listener","trigger","promises","triggerOnce","camelToDasherize","string","g","dasherizeToCamel","toUpperCase","capitalizeFirstLetter","path","def","pathParts","safeTimeout","interval","defineLazyProp","arrayFrom","isObject","isObjectObject","isPlainObject","replaceObject","replacer","fullKey","itemKey","child","copyProp","descriptor","regex","start","RegExp","groups","end","regexAll","isDefined","cycle","debounce","isRegex","weakMapMemoize","arg","weakMapMemoizePromise","cleanup","cleanErr","tasks","cleaned","cleaner","register","task","shift","tryCatch","removeFromArray","arr","assertExists","thing","unique","constHas","constant","dedupeErrors","seenErrors","seenStringifiedErrors","stringifiedError","ExtendableError","captureStackTrace","ReferenceError","KEY_CODES","ENTER","SPACE","ATTRIBUTES","UID","UID_HASH_LENGTH","getBody","body","isDocumentReady","readyState","isDocumentInteractive","urlEncode","waitForWindowReady","addEventListener","waitForDocumentReady","setInterval","clearInterval","waitForDocumentBody","parseQuery","queryString","params","pair","getQueryParam","search","urlWillRedirectPage","url","href","formatQuery","extendQuery","originalQuery","props","extendUrl","originalUrl","originalHash","query","hashString","redirect","hasMetaViewPort","meta","isElementVisible","el","offsetWidth","offsetHeight","getClientRects","getPerformance","performance","timing","connectEnd","navigationStart","enablePerformance","getPageRenderTime","domInteractive","htmlEncode","html","isBrowser","querySelectorAll","selector","onClick","element","event","keyCode","getScript","reverse","scripts","getElementsByTagName","script","src","isLocalStorageEnabled","localStorage","setItem","getItem","removeItem","getBrowserLocales","nav","locales","languages","language","userLanguage","locale","country","lang","appendChild","container","isElement","Element","nodeType","style","getElementSafe","id","getElement","elementReady","awaitFrameLoadPromises","PopupOpenError","popup","left","outerWidth","screenX","screenY","toolbar","menubar","resizable","scrollbars","open","close","writeToWindow","write","err2","writeElementToWindow","tag","tagName","children","removeChild","setStyle","styleText","styleSheet","cssText","createTextNode","awaitFrameLoad","cleanIframes","linkFrameWindow","awaitFrameWindow","loadedFrame","createElement","class","className","setAttribute","attributes","innerHTML","iframe","allowTransparency","backgroundColor","border","hasAttribute","removeEventListener","bindEvents","eventNames","VENDOR_PREFIXES","setVendorCSS","capitalizedName","ANIMATION_START_EVENTS","ANIMATION_END_EVENTS","animate","clean","startTimeout","endTimeout","startEvent","endEvent","hasStarted","cleanUp","animationName","stopPropagation","makeElementVisible","setProperty","makeElementInvisible","showElement","hideElement","destroyElement","showAndAnimate","animation","animateAndHide","addClass","classList","add","removeClass","remove","isElementClosed","watchElementForClose","sacrificialFrame","sacrificialFrameWin","mutationObservers","disconnect","elementClosed","MutationObserver","mutationElement","parentElement","mutationObserver","observe","childList","display","frameWin","assertSameDomain","fixScripts","newScript","textContent","replaceChild","onResize","currentWidth","currentHeight","canceled","observer","check","newWidth","newHeight","ResizeObserver","subtree","characterData","getResourceLoadTime","getEntries","entries","duration","isShadowElement","getShadowRoot","getShadowHost","shadowRoot","insertShadowSlot","shadowHost","slotName","slot","slotProvider","preventClickFocus","onFocus","preventDefault","blur","getStackTrace","currentScript","getCurrentScript","stackDetails","exec","scriptLocation","inferCurrentScript","currentUID","getCurrentScriptUID","getAttribute","hashedString","dataset","submitForm","form","input","submit","getStorage","lifetime","accessedStorage","STORAGE_KEY","newStateID","getState","storage","localStorageEnabled","rawStorage","parse","getID","getSession","session","__session__","created","guid","isStateFresh","getSessionState","state","getSessionID","getBelterExperimentStorage","isEventUnique","loggedBeacons","getRandomInteger","range","experiment","group","sample","logTreatment","logCheckpoint","sticky","throttle","throttlePercentiles","getThrottlePercentile","treatment","started","forced","exp","isEnabled","isDisabled","getTreatment","log","checkpoint","payload","logStart","logComplete","getGlobalNameSpace","version","globalKey","namespace","defValue","headerBuilders","request","headers","json","data","normalizedHeaders","builtHeaders","headerBuilder","xhr","XMLHttpRequest","responseHeaders","rawHeaders","trim","parseHeaders","getAllResponseHeaders","contentType","isJSON","responseBody","responseText","evt","setRequestHeader","ontimeout","send","addHeaderBuilder","TYPES","memoized","isPerc","isPx","toNum","toPx","toCSS","percOf","normalizeDimension","dim","wrapPromise","expected","timer","expect","avoid","expectError","wait","prom"],"mappings":"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","file":"belter.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"belter\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"belter\"] = factory();\n\telse\n\t\troot[\"belter\"] = factory();\n})((typeof self !== 'undefined' ? self : this), function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 4);\n","/* @flow */\n\n// eslint-disable-next-line import/no-commonjs\nmodule.exports = require('./dist/zalgo-promise');\n","// eslint-disable-next-line import/no-commonjs\nmodule.exports = require('./dist/cross-domain-safe-weakmap');\n","!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"ZalgoPromise\",[],t):\"object\"==typeof exports?exports.ZalgoPromise=t():e.ZalgoPromise=t()}(\"undefined\"!=typeof self?self:this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return{}.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=0)}([function(e,t,r){\"use strict\";function n(e){try{if(!e)return!1;if(\"undefined\"!=typeof Promise&&e instanceof Promise)return!0;if(\"undefined\"!=typeof window&&\"function\"==typeof window.Window&&e instanceof window.Window)return!1;if(\"undefined\"!=typeof window&&\"function\"==typeof window.constructor&&e instanceof window.constructor)return!1;var t={}.toString;if(t){var r=t.call(e);if(\"[object Window]\"===r||\"[object global]\"===r||\"[object DOMWindow]\"===r)return!1}if(\"function\"==typeof e.then)return!0}catch(e){return!1}return!1}r.r(t),r.d(t,\"ZalgoPromise\",(function(){return l}));var o,i=[],c=[],u=0;function s(){if(!u&&o){var e=o;o=null,e.resolve()}}function f(){u+=1}function a(){u-=1,s()}var l=function(){function e(e){var t=this;if(this.resolved=void 0,this.rejected=void 0,this.errorHandled=void 0,this.value=void 0,this.error=void 0,this.handlers=void 0,this.dispatching=void 0,this.stack=void 0,this.resolved=!1,this.rejected=!1,this.errorHandled=!1,this.handlers=[],e){var r,n,o=!1,i=!1,c=!1;f();try{e((function(e){c?t.resolve(e):(o=!0,r=e)}),(function(e){c?t.reject(e):(i=!0,n=e)}))}catch(e){return a(),void this.reject(e)}a(),c=!0,o?this.resolve(r):i&&this.reject(n)}}var t=e.prototype;return t.resolve=function(e){if(this.resolved||this.rejected)return this;if(n(e))throw new Error(\"Can not resolve promise with another promise\");return this.resolved=!0,this.value=e,this.dispatch(),this},t.reject=function(e){var t=this;if(this.resolved||this.rejected)return this;if(n(e))throw new Error(\"Can not reject promise with another promise\");if(!e){var r=e&&\"function\"==typeof e.toString?e.toString():{}.toString.call(e);e=new Error(\"Expected reject to be called with Error, got \"+r)}return this.rejected=!0,this.error=e,this.errorHandled||setTimeout((function(){t.errorHandled||function(e,t){if(-1===i.indexOf(e)){i.push(e),setTimeout((function(){throw e}),1);for(var r=0;r<c.length;r++)c[r](e,t)}}(e,t)}),1),this.dispatch(),this},t.asyncReject=function(e){return this.errorHandled=!0,this.reject(e),this},t.dispatch=function(){var t=this.resolved,r=this.rejected,o=this.handlers;if(!this.dispatching&&(t||r)){this.dispatching=!0,f();for(var i=function(e,t){return e.then((function(e){t.resolve(e)}),(function(e){t.reject(e)}))},c=0;c<o.length;c++){var u=o[c],s=u.onSuccess,l=u.onError,h=u.promise,d=void 0;if(t)try{d=s?s(this.value):this.value}catch(e){h.reject(e);continue}else if(r){if(!l){h.reject(this.error);continue}try{d=l(this.error)}catch(e){h.reject(e);continue}}d instanceof e&&(d.resolved||d.rejected)?(d.resolved?h.resolve(d.value):h.reject(d.error),d.errorHandled=!0):n(d)?d instanceof e&&(d.resolved||d.rejected)?d.resolved?h.resolve(d.value):h.reject(d.error):i(d,h):h.resolve(d)}o.length=0,this.dispatching=!1,a()}},t.then=function(t,r){if(t&&\"function\"!=typeof t&&!t.call)throw new Error(\"Promise.then expected a function for success handler\");if(r&&\"function\"!=typeof r&&!r.call)throw new Error(\"Promise.then expected a function for error handler\");var n=new e;return this.handlers.push({promise:n,onSuccess:t,onError:r}),this.errorHandled=!0,this.dispatch(),n},t.catch=function(e){return this.then(void 0,e)},t.finally=function(t){if(t&&\"function\"!=typeof t&&!t.call)throw new Error(\"Promise.finally expected a function\");return this.then((function(r){return e.try(t).then((function(){return r}))}),(function(r){return e.try(t).then((function(){throw r}))}))},t.timeout=function(e,t){var r=this;if(this.resolved||this.rejected)return this;var n=setTimeout((function(){r.resolved||r.rejected||r.reject(t||new Error(\"Promise timed out after \"+e+\"ms\"))}),e);return this.then((function(e){return clearTimeout(n),e}))},t.toPromise=function(){if(\"undefined\"==typeof Promise)throw new TypeError(\"Could not find Promise\");return Promise.resolve(this)},e.resolve=function(t){return t instanceof e?t:n(t)?new e((function(e,r){return t.then(e,r)})):(new e).resolve(t)},e.reject=function(t){return(new e).reject(t)},e.asyncReject=function(t){return(new e).asyncReject(t)},e.all=function(t){var r=new e,o=t.length,i=[];if(!o)return r.resolve(i),r;for(var c=function(e,t,n){return t.then((function(t){i[e]=t,0==(o-=1)&&r.resolve(i)}),(function(e){n.reject(e)}))},u=0;u<t.length;u++){var s=t[u];if(s instanceof e){if(s.resolved){i[u]=s.value,o-=1;continue}}else if(!n(s)){i[u]=s,o-=1;continue}c(u,e.resolve(s),r)}return 0===o&&r.resolve(i),r},e.hash=function(t){var r={},o=[],i=function(e){if(t.hasOwnProperty(e)){var i=t[e];n(i)?o.push(i.then((function(t){r[e]=t}))):r[e]=i}};for(var c in t)i(c);return e.all(o).then((function(){return r}))},e.map=function(t,r){return e.all(t.map(r))},e.onPossiblyUnhandledException=function(e){return function(e){return c.push(e),{cancel:function(){c.splice(c.indexOf(e),1)}}}(e)},e.try=function(t,r,n){if(t&&\"function\"!=typeof t&&!t.call)throw new Error(\"Promise.try expected a function\");var o;f();try{o=t.apply(r,n||[])}catch(t){return a(),e.reject(t)}return a(),e.resolve(o)},e.delay=function(t){return new e((function(e){setTimeout(e,t)}))},e.isPromise=function(t){return!!(t&&t instanceof e)||n(t)},e.flush=function(){return t=o=o||new e,s(),t;var t},e}()}])}));\n//# sourceMappingURL=zalgo-promise.js.map","!function(e,t){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=t():\"function\"==typeof define&&define.amd?define(\"xdsweakmap\",[],t):\"object\"==typeof exports?exports.xdsweakmap=t():e.xdsweakmap=t()}(\"undefined\"!=typeof self?self:this,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,\"a\",t),t},r.o=function(e,t){return{}.hasOwnProperty.call(e,t)},r.p=\"\",r(r.s=0)}([function(e,t,r){\"use strict\";r.r(t),r.d(t,\"WeakMap\",(function(){return l}));var n=\"Call was rejected by callee.\\r\\n\";function i(e){return void 0===e&&(e=window),\"about:\"===e.location.protocol}function a(e){try{return!0}catch(e){}return!1}function o(e){void 0===e&&(e=window);var t=e.location;if(!t)throw new Error(\"Can not read window location\");var r=t.protocol;if(!r)throw new Error(\"Can not read window protocol\");if(\"file:\"===r)return\"file://\";if(\"about:\"===r){var n=function(e){if(void 0===e&&(e=window),e)try{if(e.parent&&e.parent!==e)return e.parent}catch(e){}}(e);return n&&a()?o(n):\"about://\"}var i=t.host;if(!i)throw new Error(\"Can not read window host\");return r+\"//\"+i}function c(e){void 0===e&&(e=window);var t=o(e);return t&&e.mockDomain&&0===e.mockDomain.indexOf(\"mock:\")?e.mockDomain:t}var u=[],f=[];function s(e,t){void 0===t&&(t=!0);try{if(e===window)return!1}catch(e){return!0}try{if(!e)return!0}catch(e){return!0}try{if(e.closed)return!0}catch(e){return!e||e.message!==n}if(t&&function(e){if(!function(e){try{if(e===window)return!0}catch(e){}try{var t=Object.getOwnPropertyDescriptor(e,\"location\");if(t&&!1===t.enumerable)return!1}catch(e){}try{if(i(e)&&a())return!0}catch(e){}try{if(o(e)===o(window))return!0}catch(e){}return!1}(e))return!1;try{if(e===window)return!0;if(i(e)&&a())return!0;if(c(window)===c(e))return!0}catch(e){}return!1}(e))try{if(e.mockclosed)return!0}catch(e){}try{if(!e.parent||!e.top)return!0}catch(e){}var r=function(e,t){for(var r=0;r<e.length;r++)try{if(e[r]===t)return r}catch(e){}return-1}(u,e);if(-1!==r){var s=f[r];if(s&&function(e){if(!e.contentWindow)return!0;if(!e.parentNode)return!0;var t=e.ownerDocument;if(t&&t.documentElement&&!t.documentElement.contains(e)){for(var r=e;r.parentNode&&r.parentNode!==r;)r=r.parentNode;if(!r.host||!t.documentElement.contains(r.host))return!0}return!1}(s))return!0}return!1}function d(e){try{if(e===window)return!0}catch(e){if(e&&e.message===n)return!0}try{if(\"[object Window]\"==={}.toString.call(e))return!0}catch(e){if(e&&e.message===n)return!0}try{if(window.Window&&e instanceof window.Window)return!0}catch(e){if(e&&e.message===n)return!0}try{if(e&&e.self===e)return!0}catch(e){if(e&&e.message===n)return!0}try{if(e&&e.parent===e)return!0}catch(e){if(e&&e.message===n)return!0}try{if(e&&e.top===e)return!0}catch(e){if(e&&e.message===n)return!0}try{if(e&&\"__unlikely_value__\"===e.__cross_domain_utils_window_check__)return!1}catch(e){return!0}try{if(\"postMessage\"in e&&\"self\"in e&&\"location\"in e)return!0}catch(e){}return!1}function h(e,t){for(var r=0;r<e.length;r++)try{if(e[r]===t)return r}catch(e){}return-1}var l=function(){function e(){if(this.name=void 0,this.weakmap=void 0,this.keys=void 0,this.values=void 0,this.name=\"__weakmap_\"+(1e9*Math.random()>>>0)+\"__\",function(){if(\"undefined\"==typeof WeakMap)return!1;if(void 0===Object.freeze)return!1;try{var e=new WeakMap,t={};return Object.freeze(t),e.set(t,\"__testvalue__\"),\"__testvalue__\"===e.get(t)}catch(e){return!1}}())try{this.weakmap=new WeakMap}catch(e){}this.keys=[],this.values=[]}var t=e.prototype;return t._cleanupClosedWindows=function(){for(var e=this.weakmap,t=this.keys,r=0;r<t.length;r++){var n=t[r];if(d(n)&&s(n)){if(e)try{e.delete(n)}catch(e){}t.splice(r,1),this.values.splice(r,1),r-=1}}},t.isSafeToReadWrite=function(e){return!d(e)},t.set=function(e,t){if(!e)throw new Error(\"WeakMap expected key\");var r=this.weakmap;if(r)try{r.set(e,t)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e))try{var n=this.name,i=e[n];return void(i&&i[0]===e?i[1]=t:Object.defineProperty(e,n,{value:[e,t],writable:!0}))}catch(e){}this._cleanupClosedWindows();var a=this.keys,o=this.values,c=h(a,e);-1===c?(a.push(e),o.push(t)):o[c]=t},t.get=function(e){if(!e)throw new Error(\"WeakMap expected key\");var t=this.weakmap;if(t)try{if(t.has(e))return t.get(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e))try{var r=e[this.name];return r&&r[0]===e?r[1]:void 0}catch(e){}this._cleanupClosedWindows();var n=h(this.keys,e);if(-1!==n)return this.values[n]},t.delete=function(e){if(!e)throw new Error(\"WeakMap expected key\");var t=this.weakmap;if(t)try{t.delete(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e))try{var r=e[this.name];r&&r[0]===e&&(r[0]=r[1]=void 0)}catch(e){}this._cleanupClosedWindows();var n=this.keys,i=h(n,e);-1!==i&&(n.splice(i,1),this.values.splice(i,1))},t.has=function(e){if(!e)throw new Error(\"WeakMap expected key\");var t=this.weakmap;if(t)try{if(t.has(e))return!0}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e))try{var r=e[this.name];return!(!r||r[0]!==e)}catch(e){}return this._cleanupClosedWindows(),-1!==h(this.keys,e)},t.getOrSet=function(e,t){if(this.has(e))return this.get(e);var r=t();return this.set(e,r),r},e}()}])}));\n//# sourceMappingURL=cross-domain-safe-weakmap.js.map","export const iPhoneScreenHeightMatrix = {\n    '926': {\n        device:          'iPhone 12 Pro Max',\n        textSizeHeights: [ 752, 748, 744, 738 ],\n        zoomHeight:      {\n            '1.15': [ 752, 747, 744, 738 ],\n            '1.25': [ 753, 748, 744, 738 ],\n            '1.5':  [ 752, 749, 744, 738 ],\n            '1.75': [ 753, 747, 744, 739 ],\n            '2':    [ 752, 748, 744 ],\n            // 738 removed as same in Safari\n            '2.5':  [ 753, 748 ],\n            // 745, 738 removed as same in Safari\n            '3':    [ 753, 744 ] // 747, 738 removed as same in Safari\n\n        },\n        maybeSafari: {\n            '2':   [ 738 ],\n            '2.5': [ 745, 738 ],\n            '3':   [ 747, 738 ]\n        }\n    },\n    '896': {\n        device:          'iPhone XS Max, iPhone 11 Pro Max, iPhone XR, iPhone 11',\n        textSizeHeights: [ 721, 717, 713, 707 ],\n        zoomHeight:      {\n            '1.15': [ 721, 716, 713, 707 ],\n            '1.25': [ 721, 718, 713, 708 ],\n            '1.5':  [ 722, 717, 713 ],\n            // 707 removed as same in Safari\n            '1.75': [ 721, 718, 712, 707 ],\n            '2':    [ 722, 718, 714, 708 ],\n            '2.5':  [ 720, 718, 713, 708 ],\n            '3':    [ 720, 717, 708 ] // 714 removed as same in Safari\n\n        },\n        maybeSafari: {\n            '1.5': [ 707 ],\n            '3':   [ 714 ]\n        }\n    },\n    '844': {\n        device:          'iPhone 12, iPhone 12 Pro',\n        textSizeHeights: [ 670, 666, 662, 656 ],\n        zoomHeight:      {\n            '1.15': [ 670, 666, 662 ],\n            // 656 removed as same in Safari\n            '1.25': [ 670, 666, 663, 656 ],\n            '1.5':  [ 671, 666, 662 ],\n            // 656 removed as same in Safari\n            '1.75': [ 670, 667, 662, 656 ],\n            '2':    [ 670, 666, 662 ],\n            // 656 removed as same in Safari\n            '2.5':  [ 670, 663 ],\n            // 665, 655 removed as same in Safari\n            '3':    [ 669, 666, 663, 657 ] // 663 removed as same in Safari\n\n        },\n        maybeSafari: {\n            '1.15': [ 656 ],\n            '1.5':  [ 656 ],\n            '2':    [ 656 ],\n            '2.5':  [ 665, 655 ],\n            '3':    [ 663 ]\n        }\n    },\n    '812': {\n        device:          'iPhone X, iPhone XS, iPhone 11 Pro, iPhone 12 Mini',\n        textSizeHeights: [ 641, 637, 633, 627 ],\n        zoomHeight:      {\n            '1.15': [ 641, 637, 633, 627 ],\n            '1.25': [ 641, 638, 633, 628 ],\n            '1.5':  [ 641, 638, 633, 627 ],\n            '1.75': [ 641, 637, 634 ],\n            // 627 removed as same in Safari\n            '2':    [ 642, 638, 634, 628 ],\n            '2.5':  [ 640, 638, 633, 628 ],\n            '3':    [ 642, 633 ] // 636, 627 removed as same in Safari\n\n        },\n        maybeSafari: {\n            '1.75': [ 627 ],\n            '3':    [ 636, 627 ]\n        }\n    },\n    '736': {\n        device:          'iPhone 6 Plus, iPhone 6S Plus, iPhone 7 Plus, iPhone 8 Plus',\n        textSizeHeights: [ 628, 624, 620, 614 ],\n        zoomHeight:      {\n            '1.15': [ 628, 624, 620, 614 ],\n            '1.25': [ 628, 624, 620, 614 ],\n            '1.5':  [ 629, 624, 620 ],\n            // 614\n            '1.75': [ 628, 625, 620, 614 ],\n            '2':    [ 628, 624, 620 ],\n            // 614\n            '2.5':  [ 628, 625, 620, 615 ],\n            '3':    [ 627, 624, 615 ] // 621\n\n        },\n        maybeSafari: {\n            '1.5': [ 614 ],\n            '2':   [ 614 ],\n            '3':   [ 621 ]\n        }\n    },\n    '667': {\n        device:          'iPhone 6, iPhone 6S, iPhone 7, iPhone 8,  iPhone SE2',\n        textSizeHeights: [ 559, 555, 551, 545 ],\n        zoomHeight:      {\n            '1.15': [ 559, 555, 551, 545 ],\n            '1.25': [ 559, 555, 551, 545 ],\n            '1.5':  [ 560, 555, 551 ],\n            // 545\n            '1.75': [ 558, 555, 551 ],\n            // 544\n            '2':    [ 560, 556, 552, 546 ],\n            '2.5':  [ 560, 555, 550 ],\n            // 545\n            '3':    [ 558, 555, 546 ] // 552\n\n        },\n        maybeSafari: {\n            '1.5':  [ 545 ],\n            '1.75': [ 544 ],\n            '2.5':  [ 545 ],\n            '3':    [ 552 ]\n        }\n    }\n};\n","import { iPhoneScreenHeightMatrix } from './screenHeights';\n\nexport function getUserAgent(): string {\n    // @ts-ignore - mockUserAgent does not exist natively\n    return window.navigator.mockUserAgent || window.navigator.userAgent;\n}\nexport function isDevice(userAgent: string = getUserAgent()): boolean {\n    if (userAgent.match(/Android|webOS|iPhone|iPad|iPod|bada|Symbian|Palm|CriOS|BlackBerry|IEMobile|WindowsMobile|Opera Mini/i)) {\n        return true;\n    }\n\n    return false;\n}\nexport function isWebView(): boolean {\n    const userAgent = getUserAgent();\n    return (/(iPhone|iPod|iPad|Macintosh).*AppleWebKit(?!.*Safari)|.*WKWebView/i).test(userAgent) || (/\\bwv\\b/).test(userAgent) || (/Android.*Version\\/(\\d)\\.(\\d)/i).test(userAgent);\n}\nexport function isStandAlone(): boolean {\n    // @ts-ignore - standalone does not exist natively\n    return window.navigator.standalone === true || window.matchMedia('(display-mode: standalone)').matches;\n}\nexport function isFacebookWebView(ua: string = getUserAgent()): boolean {\n    return (/FBAN/).test(ua) || (/FBAV/).test(ua);\n}\nexport function isFirefox(ua: string = getUserAgent()): boolean {\n    return (/Firefox/i).test(ua);\n}\nexport function isFirefoxIOS(ua: string = getUserAgent()): boolean {\n    return (/FxiOS/i).test(ua);\n}\nexport function isEdgeIOS(ua: string = getUserAgent()): boolean {\n    return (/EdgiOS/i).test(ua);\n}\nexport function isOperaMini(ua: string = getUserAgent()): boolean {\n    return (/Opera Mini/i).test(ua);\n}\nexport function isAndroid(ua: string = getUserAgent()): boolean {\n    return (/Android/).test(ua);\n}\nexport function isIos(ua: string = getUserAgent()): boolean {\n    return (/iPhone|iPod|iPad/).test(ua);\n}\nexport function isGoogleSearchApp(ua: string = getUserAgent()): boolean {\n    return (/\\bGSA\\b/).test(ua);\n}\nexport function isQQBrowser(ua: string = getUserAgent()): boolean {\n    return (/QQBrowser/).test(ua);\n}\nexport function isIosWebview(ua: string = getUserAgent()): boolean {\n    if (isIos(ua)) {\n        if (isGoogleSearchApp(ua)) {\n            return true;\n        }\n\n        return (/.+AppleWebKit(?!.*Safari)|.*WKWebView/).test(ua);\n    }\n\n    return false;\n}\nexport function isSFVC(ua: string = getUserAgent()): boolean {\n    if (isIos(ua)) {\n        // @ts-ignore no types for screenHeights.ts yet\n        const device = iPhoneScreenHeightMatrix[window.outerHeight];\n\n        if (!device) {\n            return false;\n        }\n\n        const height = window.innerHeight;\n        const scale = Math.round(window.screen.width / window.innerWidth * 100) / 100;\n        const computedHeight = Math.round(height * scale);\n\n        if (scale > 1 && device.zoomHeight[scale]) {\n            return device.zoomHeight[scale].indexOf(computedHeight) !== -1;\n        } else {\n            return device.textSizeHeights.indexOf(computedHeight) !== -1;\n        }\n    }\n\n    return false;\n}\nexport function isSFVCorSafari(ua: string = getUserAgent()): boolean {\n    if (isIos(ua)) {\n        const sfvc = isSFVC(ua);\n        // @ts-ignore no types for screenHeights.ts yet\n        const device = iPhoneScreenHeightMatrix[window.outerHeight];\n\n        if (!device) {\n            return false;\n        }\n\n        const height = window.innerHeight;\n        const scale = Math.round(window.screen.width / window.innerWidth * 100) / 100;\n        const computedHeight = Math.round(height * scale);\n        const possibleSafariSizes = device.maybeSafari;\n        let maybeSafari = false;\n\n        if (scale > 1 && possibleSafariSizes[scale] && possibleSafariSizes[scale].indexOf(computedHeight) !== -1) {\n            maybeSafari = true;\n        }\n\n        return sfvc || maybeSafari;\n    }\n\n    return false;\n}\nexport function isAndroidWebview(ua: string = getUserAgent()): boolean {\n    if (isAndroid(ua)) {\n        return (/Version\\/[\\d.]+/).test(ua) && !isOperaMini(ua);\n    }\n\n    return false;\n}\nexport function isIE(): boolean {\n    // @ts-ignore\n    if (window.document.documentMode) {\n        return true;\n    }\n\n    return Boolean(window.navigator && window.navigator.userAgent && (/Edge|MSIE|rv:11/i).test(window.navigator.userAgent));\n}\nexport function isIECompHeader(): boolean {\n    const mHttp = window.document.querySelector('meta[http-equiv=\"X-UA-Compatible\"]');\n    const mContent = window.document.querySelector('meta[content=\"IE=edge\"]');\n\n    if (mHttp && mContent) {\n        return true;\n    }\n\n    return false;\n}\nexport function isElectron(): boolean {\n    if (typeof process !== 'undefined' && process.versions && process.versions.electron) {\n        return true;\n    }\n\n    return false;\n}\nexport function isIEIntranet(): boolean {\n    // This status check only works for older versions of IE with document.documentMode set\n    // @ts-ignore - documentMode was removed from tsc\n    if (window.document.documentMode) {\n        try {\n            const status = window.status;\n            window.status = 'testIntranetMode';\n\n            if (window.status === 'testIntranetMode') {\n                window.status = status;\n                return true;\n            }\n\n            return false;\n        } catch (err) {\n            return false;\n        }\n    }\n\n    return false;\n}\nexport function isMacOsCna(): boolean {\n    const userAgent = getUserAgent();\n    return (/Macintosh.*AppleWebKit(?!.*Safari)/i).test(userAgent);\n}\nexport function supportsPopups(ua: string = getUserAgent()): boolean {\n    return !(isIosWebview(ua) || isAndroidWebview(ua) || isOperaMini(ua) || isFirefoxIOS(ua) || isEdgeIOS(ua) || isFacebookWebView(ua) || isQQBrowser(ua) || isElectron() || isMacOsCna() || isStandAlone());\n}\nexport function isChrome(ua: string = getUserAgent()): boolean {\n    return (/Chrome|Chromium|CriOS/).test(ua);\n}\nexport function isSafari(ua: string = getUserAgent()): boolean {\n    return (/Safari/).test(ua) && !isChrome(ua);\n}\nexport function isApplePaySupported(): boolean {\n    try {\n        // @ts-ignore - ApplePaySession not native in tsc\n        if (window.ApplePaySession && window.ApplePaySession.supportsVersion(3) && window.ApplePaySession.canMakePayments()) {\n            return true;\n        }\n    } catch (e) {\n        return false;\n    }\n\n    return false;\n}\n","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"@babel/runtime/helpers/esm/setPrototypeOf\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","/* eslint max-lines: 0 */\nimport { isRegex, noop } from './util';\nimport { PROTOCOL, WILDCARD } from './constants';\nvar IE_WIN_ACCESS_ERROR = 'Call was rejected by callee.\\r\\n';\nexport function isFileProtocol(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  return win.location.protocol === PROTOCOL.FILE;\n}\nexport function isAboutProtocol(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  return win.location.protocol === PROTOCOL.ABOUT;\n}\nexport function getParent(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  if (!win) {\n    return;\n  }\n\n  try {\n    if (win.parent && win.parent !== win) {\n      return win.parent;\n    }\n  } catch (err) {// pass\n  }\n}\nexport function getOpener(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  if (!win) {\n    return;\n  } // Make sure we're not actually an iframe which has had window.open() called on us\n\n\n  if (getParent(win)) {\n    return;\n  }\n\n  try {\n    return win.opener;\n  } catch (err) {// pass\n  }\n}\nexport function canReadFromWindow(win) {\n  try {\n    noop(win && win.location && win.location.href);\n    return true;\n  } catch (err) {// pass\n  }\n\n  return false;\n}\nexport function getActualDomain(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  var location = win.location;\n\n  if (!location) {\n    throw new Error(\"Can not read window location\");\n  }\n\n  var protocol = location.protocol;\n\n  if (!protocol) {\n    throw new Error(\"Can not read window protocol\");\n  }\n\n  if (protocol === PROTOCOL.FILE) {\n    return PROTOCOL.FILE + \"//\";\n  }\n\n  if (protocol === PROTOCOL.ABOUT) {\n    // @ts-ignore - trying to reassing to something that might be window\n    var parent = getParent(win);\n\n    if (parent && canReadFromWindow(parent)) {\n      // @ts-ignore\n      return getActualDomain(parent);\n    }\n\n    return PROTOCOL.ABOUT + \"//\";\n  }\n\n  var host = location.host;\n\n  if (!host) {\n    throw new Error(\"Can not read window host\");\n  }\n\n  return protocol + \"//\" + host;\n} // @ts-ignore\n\nexport function getDomain(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  var domain = getActualDomain(win); // @ts-ignore - mockDomain\n\n  if (domain && win.mockDomain && win.mockDomain.indexOf(PROTOCOL.MOCK) === 0) {\n    // @ts-ignore - mockDomain\n    return win.mockDomain;\n  }\n\n  return domain;\n}\nexport function isBlankDomain(win) {\n  try {\n    if (!win.location.href) {\n      return true;\n    }\n\n    if (win.location.href === 'about:blank') {\n      return true;\n    }\n  } catch (err) {// pass\n  }\n\n  return false;\n}\nexport function isActuallySameDomain(win) {\n  try {\n    if (win === window) {\n      return true;\n    }\n  } catch (err) {// pass\n  }\n\n  try {\n    var desc = Object.getOwnPropertyDescriptor(win, 'location');\n\n    if (desc && desc.enumerable === false) {\n      return false;\n    }\n  } catch (err) {// pass\n  }\n\n  try {\n    if (isAboutProtocol(win) && canReadFromWindow(win)) {\n      return true;\n    }\n  } catch (err) {// pass\n  }\n\n  try {\n    if (getActualDomain(win) === getActualDomain(window)) {\n      return true;\n    }\n  } catch (err) {// pass\n  }\n\n  return false;\n}\nexport function isSameDomain(win) {\n  // @ts-ignore\n  if (!isActuallySameDomain(win)) {\n    return false;\n  }\n\n  try {\n    if (win === window) {\n      return true;\n    }\n\n    if (isAboutProtocol(win) && canReadFromWindow(win)) {\n      return true;\n    }\n\n    if (getDomain(window) === getDomain(win)) {\n      return true;\n    }\n  } catch (err) {// pass\n  }\n\n  return false;\n}\nexport function assertSameDomain(win) {\n  if (!isSameDomain(win)) {\n    throw new Error(\"Expected window to be same domain\");\n  }\n\n  return win;\n}\nexport function getParents(win) {\n  var result = [];\n\n  try {\n    while (win.parent !== win) {\n      result.push(win.parent);\n      win = win.parent;\n    }\n  } catch (err) {// pass\n  }\n\n  return result;\n}\nexport function isAncestorParent(parent, child) {\n  if (!parent || !child) {\n    return false;\n  }\n\n  var childParent = getParent(child);\n\n  if (childParent) {\n    return childParent === parent;\n  }\n\n  if (getParents(child).indexOf(parent) !== -1) {\n    return true;\n  }\n\n  return false;\n}\nexport function getFrames(win) {\n  var result = [];\n  var frames;\n\n  try {\n    frames = win.frames;\n  } catch (err) {\n    frames = win;\n  }\n\n  var len;\n\n  try {\n    len = frames.length;\n  } catch (err) {// pass\n  }\n\n  if (len === 0) {\n    return result;\n  }\n\n  if (len) {\n    for (var i = 0; i < len; i++) {\n      var frame = void 0;\n\n      try {\n        frame = frames[i];\n      } catch (err) {\n        continue;\n      }\n\n      result.push(frame);\n    }\n\n    return result;\n  }\n\n  for (var _i = 0; _i < 100; _i++) {\n    var _frame = void 0;\n\n    try {\n      _frame = frames[_i];\n    } catch (err) {\n      return result;\n    }\n\n    if (!_frame) {\n      return result;\n    }\n\n    result.push(_frame);\n  }\n\n  return result;\n}\nexport function getAllChildFrames(win) {\n  var result = [];\n\n  for (var _i3 = 0, _getFrames2 = getFrames(win); _i3 < _getFrames2.length; _i3++) {\n    var frame = _getFrames2[_i3];\n    result.push(frame);\n\n    for (var _i5 = 0, _getAllChildFrames2 = getAllChildFrames(frame); _i5 < _getAllChildFrames2.length; _i5++) {\n      var childFrame = _getAllChildFrames2[_i5];\n      result.push(childFrame);\n    }\n  }\n\n  return result;\n}\nexport function getTop(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  try {\n    if (win.top) {\n      return win.top;\n    }\n  } catch (err) {// pass\n  }\n\n  if (getParent(win) === win) {\n    return win;\n  }\n\n  try {\n    if (isAncestorParent(window, win) && window.top) {\n      return window.top;\n    }\n  } catch (err) {// pass\n  }\n\n  try {\n    if (isAncestorParent(win, window) && window.top) {\n      return window.top;\n    }\n  } catch (err) {// pass\n  }\n\n  for (var _i7 = 0, _getAllChildFrames4 = getAllChildFrames(win); _i7 < _getAllChildFrames4.length; _i7++) {\n    var frame = _getAllChildFrames4[_i7];\n\n    try {\n      if (frame.top) {\n        return frame.top;\n      }\n    } catch (err) {// pass\n    }\n\n    if (getParent(frame) === frame) {\n      return frame;\n    }\n  }\n}\nexport function getNextOpener(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  return getOpener(getTop(win) || win);\n}\nexport function getUltimateTop(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  var opener = getNextOpener(win);\n\n  if (opener) {\n    return getUltimateTop(opener);\n  }\n\n  return top;\n}\nexport function getAllFramesInWindow(win) {\n  var top = getTop(win);\n\n  if (!top) {\n    throw new Error(\"Can not determine top window\");\n  }\n\n  var result = [].concat(getAllChildFrames(top), [top]); // Win may be in shadow dom\n\n  if (result.indexOf(win) === -1) {\n    result = [].concat(result, [win], getAllChildFrames(win));\n  }\n\n  return result;\n}\nexport function getAllWindows(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  var frames = getAllFramesInWindow(win);\n  var opener = getNextOpener(win);\n\n  if (opener) {\n    return [].concat(getAllWindows(opener), frames);\n  } else {\n    return frames;\n  }\n}\nexport function isTop(win) {\n  return win === getTop(win);\n}\nexport function isFrameWindowClosed(frame) {\n  if (!frame.contentWindow) {\n    return true;\n  }\n\n  if (!frame.parentNode) {\n    return true;\n  }\n\n  var doc = frame.ownerDocument;\n\n  if (doc && doc.documentElement && !doc.documentElement.contains(frame)) {\n    var parent = frame;\n\n    while (parent.parentNode && parent.parentNode !== parent) {\n      // @ts-ignore\n      parent = parent.parentNode;\n    } // @ts-ignore\n\n\n    if (!parent.host || !doc.documentElement.contains(parent.host)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction safeIndexOf(collection, item) {\n  for (var i = 0; i < collection.length; i++) {\n    try {\n      if (collection[i] === item) {\n        return i;\n      }\n    } catch (err) {// pass\n    }\n  }\n\n  return -1;\n}\n\nvar iframeWindows = [];\nvar iframeFrames = [];\nexport function isWindowClosed(win, allowMock) {\n  if (allowMock === void 0) {\n    allowMock = true;\n  }\n\n  try {\n    if (win === window) {\n      return false;\n    }\n  } catch (err) {\n    return true;\n  }\n\n  try {\n    if (!win) {\n      return true;\n    }\n  } catch (err) {\n    return true;\n  }\n\n  try {\n    if (win.closed) {\n      return true;\n    }\n  } catch (err) {\n    // I love you so much IE\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return false;\n    }\n\n    return true;\n  }\n\n  if (allowMock && isSameDomain(win)) {\n    try {\n      // @ts-ignore\n      if (win.mockclosed) {\n        return true;\n      }\n    } catch (err) {// pass\n    }\n  } // Mobile safari\n\n\n  try {\n    if (!win.parent || !win.top) {\n      return true;\n    }\n  } catch (err) {// pass\n  } // Yes, this actually happens in IE. win === win errors out when the window\n  // is from an iframe, and the iframe was removed from the page.\n\n\n  try {\n    noop(win === win); // eslint-disable-line no-self-compare\n  } catch (err) {\n    return true;\n  } // IE orphaned frame\n\n\n  var iframeIndex = safeIndexOf(iframeWindows, win);\n\n  if (iframeIndex !== -1) {\n    var frame = iframeFrames[iframeIndex];\n\n    if (frame && isFrameWindowClosed(frame)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction cleanIframes() {\n  for (var i = 0; i < iframeWindows.length; i++) {\n    var closed = false;\n\n    try {\n      closed = iframeWindows[i].closed;\n    } catch (err) {// pass\n    }\n\n    if (closed) {\n      iframeFrames.splice(i, 1);\n      iframeWindows.splice(i, 1);\n    }\n  }\n}\n\nexport function linkFrameWindow(frame) {\n  cleanIframes();\n\n  if (frame && frame.contentWindow) {\n    try {\n      iframeWindows.push(frame.contentWindow);\n      iframeFrames.push(frame);\n    } catch (err) {// pass\n    }\n  }\n}\nexport function getUserAgent(win) {\n  win = win || window; // @ts-ignore\n\n  return win.navigator.mockUserAgent || win.navigator.userAgent;\n}\nexport function getFrameByName(win, name) {\n  var winFrames = getFrames(win);\n\n  for (var _i9 = 0; _i9 < winFrames.length; _i9++) {\n    var childFrame = winFrames[_i9];\n\n    try {\n      if (isSameDomain(childFrame) && childFrame.name === name && winFrames.indexOf(childFrame) !== -1) {\n        return childFrame;\n      }\n    } catch (err) {// pass\n    }\n  }\n\n  try {\n    // @ts-ignore\n    if (winFrames.indexOf(win.frames[name]) !== -1) {\n      // @ts-ignore\n      return win.frames[name];\n    }\n  } catch (err) {// pass\n  }\n\n  try {\n    // @ts-ignore\n    if (winFrames.indexOf(win[name]) !== -1) {\n      // @ts-ignore\n      return win[name];\n    }\n  } catch (err) {// pass\n  }\n}\nexport function findChildFrameByName(win, name) {\n  var frame = getFrameByName(win, name);\n\n  if (frame) {\n    return frame;\n  }\n\n  for (var _i11 = 0, _getFrames4 = getFrames(win); _i11 < _getFrames4.length; _i11++) {\n    var childFrame = _getFrames4[_i11];\n    var namedFrame = findChildFrameByName(childFrame, name);\n\n    if (namedFrame) {\n      return namedFrame;\n    }\n  }\n}\nexport function findFrameByName(win, name) {\n  var frame = getFrameByName(win, name);\n\n  if (frame) {\n    return frame;\n  }\n\n  var top = getTop(win) || win;\n  return findChildFrameByName(top, name);\n}\nexport function isParent(win, frame) {\n  var frameParent = getParent(frame);\n\n  if (frameParent) {\n    return frameParent === win;\n  }\n\n  for (var _i13 = 0, _getFrames6 = getFrames(win); _i13 < _getFrames6.length; _i13++) {\n    var childFrame = _getFrames6[_i13];\n\n    if (childFrame === frame) {\n      return true;\n    }\n  }\n\n  return false;\n}\nexport function isOpener(parent, child) {\n  return parent === getOpener(child);\n}\nexport function getAncestor(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  win = win || window;\n  var opener = getOpener(win);\n\n  if (opener) {\n    return opener;\n  }\n\n  var parent = getParent(win);\n\n  if (parent) {\n    return parent;\n  }\n}\nexport function getAncestors(win) {\n  var results = [];\n  var ancestor = win;\n\n  while (ancestor) {\n    // @ts-ignore\n    ancestor = getAncestor(ancestor);\n\n    if (ancestor) {\n      results.push(ancestor);\n    }\n  }\n\n  return results;\n}\nexport function isAncestor(parent, child) {\n  var actualParent = getAncestor(child);\n\n  if (actualParent) {\n    if (actualParent === parent) {\n      return true;\n    }\n\n    return false;\n  }\n\n  if (child === parent) {\n    return false;\n  }\n\n  if (getTop(child) === child) {\n    return false;\n  }\n\n  for (var _i15 = 0, _getFrames8 = getFrames(parent); _i15 < _getFrames8.length; _i15++) {\n    var frame = _getFrames8[_i15];\n\n    if (frame === child) {\n      return true;\n    }\n  }\n\n  return false;\n}\nexport function isPopup(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  return Boolean(getOpener(win));\n}\nexport function isIframe(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  return Boolean(getParent(win));\n}\nexport function isFullpage(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  return Boolean(!isIframe(win) && !isPopup(win));\n}\n\nfunction anyMatch(collection1, collection2) {\n  for (var _i17 = 0; _i17 < collection1.length; _i17++) {\n    var item1 = collection1[_i17];\n\n    for (var _i19 = 0; _i19 < collection2.length; _i19++) {\n      var item2 = collection2[_i19];\n\n      if (item1 === item2) {\n        return true;\n      }\n    }\n  }\n\n  return false;\n}\n\nexport function getDistanceFromTop(win) {\n  if (win === void 0) {\n    win = window;\n  }\n\n  var distance = 0;\n  var parent = win;\n\n  while (parent) {\n    // @ts-ignore - trying to reassing to something that might be window\n    parent = getParent(parent);\n\n    if (parent) {\n      distance += 1;\n    }\n  }\n\n  return distance;\n}\nexport function getNthParent(win, n) {\n  if (n === void 0) {\n    n = 1;\n  }\n\n  var parent = win;\n\n  for (var i = 0; i < n; i++) {\n    if (!parent) {\n      return;\n    } // @ts-ignore - trying to reassing to something that might be window\n\n\n    parent = getParent(parent);\n  }\n\n  return parent;\n}\nexport function getNthParentFromTop(win, n) {\n  if (n === void 0) {\n    n = 1;\n  }\n\n  return getNthParent(win, getDistanceFromTop(win) - n);\n}\nexport function isSameTopWindow(win1, win2) {\n  var top1 = getTop(win1) || win1;\n  var top2 = getTop(win2) || win2;\n\n  try {\n    if (top1 && top2) {\n      if (top1 === top2) {\n        return true;\n      }\n\n      return false;\n    }\n  } catch (err) {// pass\n  }\n\n  var allFrames1 = getAllFramesInWindow(win1);\n  var allFrames2 = getAllFramesInWindow(win2);\n\n  if (anyMatch(allFrames1, allFrames2)) {\n    return true;\n  }\n\n  var opener1 = getOpener(top1);\n  var opener2 = getOpener(top2);\n\n  if (opener1 && anyMatch(getAllFramesInWindow(opener1), allFrames2)) {\n    return false;\n  }\n\n  if (opener2 && anyMatch(getAllFramesInWindow(opener2), allFrames1)) {\n    return false;\n  }\n\n  return false;\n}\nexport function matchDomain(pattern, origin) {\n  if (typeof pattern === 'string') {\n    if (typeof origin === 'string') {\n      return pattern === WILDCARD || origin === pattern;\n    }\n\n    if (isRegex(origin)) {\n      return false;\n    }\n\n    if (Array.isArray(origin)) {\n      return false;\n    }\n  }\n\n  if (isRegex(pattern)) {\n    if (isRegex(origin)) {\n      return pattern.toString() === origin.toString();\n    }\n\n    if (Array.isArray(origin)) {\n      return false;\n    } // @ts-ignore - earlier already shortcutted the string case\n\n\n    return Boolean(origin.match(pattern));\n  }\n\n  if (Array.isArray(pattern)) {\n    if (Array.isArray(origin)) {\n      return JSON.stringify(pattern) === JSON.stringify(origin);\n    }\n\n    if (isRegex(origin)) {\n      return false;\n    }\n\n    return pattern.some(function (subpattern) {\n      return matchDomain(subpattern, origin);\n    });\n  }\n\n  return false;\n}\nexport function stringifyDomainPattern(pattern) {\n  if (Array.isArray(pattern)) {\n    return \"(\" + pattern.join(' | ') + \")\";\n  } else if (isRegex(pattern)) {\n    return \"RegExp(\" + pattern.toString() + \")\";\n  } else {\n    return pattern.toString();\n  }\n}\nexport function getDomainFromUrl(url) {\n  var domain;\n\n  if (url.match(/^(https?|mock|file):\\/\\//)) {\n    domain = url;\n  } else {\n    return getDomain();\n  }\n\n  domain = domain.split('/').slice(0, 3).join('/');\n  return domain;\n}\nexport function onCloseWindow(win, callback, delay, maxtime) {\n  if (delay === void 0) {\n    delay = 1000;\n  }\n\n  if (maxtime === void 0) {\n    maxtime = Infinity;\n  }\n\n  var timeout;\n\n  var check = function check() {\n    if (isWindowClosed(win)) {\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n\n      return callback();\n    }\n\n    if (maxtime <= 0) {\n      clearTimeout(timeout);\n    } else {\n      maxtime -= delay;\n      timeout = setTimeout(check, delay);\n    }\n  };\n\n  check();\n  return {\n    cancel: function cancel() {\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n    }\n  };\n} // eslint-disable-next-line complexity\n\nexport function isWindow(obj) {\n  try {\n    if (obj === window) {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    if (Object.prototype.toString.call(obj) === '[object Window]') {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    if (window.Window && obj instanceof window.Window) {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    if (obj && obj.self === obj) {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    if (obj && obj.parent === obj) {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    if (obj && obj.top === obj) {\n      return true;\n    }\n  } catch (err) {\n    if (err && err.message === IE_WIN_ACCESS_ERROR) {\n      return true;\n    }\n  }\n\n  try {\n    // @ts-ignore this equality check is a self compare\n    if (noop(obj === obj) === '__unlikely_value__') {\n      // eslint-disable-line no-self-compare\n      return false;\n    }\n  } catch (err) {\n    return true;\n  }\n\n  try {\n    if (obj && obj.__cross_domain_utils_window_check__ === '__unlikely_value__') {\n      return false;\n    }\n  } catch (err) {\n    return true;\n  }\n\n  try {\n    if ('postMessage' in obj && 'self' in obj && 'location' in obj) {\n      return true;\n    }\n  } catch (err) {// pass\n  }\n\n  return false;\n}\nexport function isBrowser() {\n  return typeof window !== 'undefined' && typeof window.location !== 'undefined';\n}\nexport function isCurrentDomain(domain) {\n  if (!isBrowser()) {\n    return false;\n  }\n\n  return getDomain() === domain;\n}\nexport function isMockDomain(domain) {\n  return domain.indexOf(PROTOCOL.MOCK) === 0;\n}\nexport function normalizeMockUrl(url) {\n  if (!isMockDomain(getDomainFromUrl(url))) {\n    return url;\n  } // @ts-ignore - global\n\n\n  if (!__TEST__) {\n    throw new Error(\"Mock urls not supported out of test mode\");\n  }\n\n  return url.replace(/^mock:\\/\\/[^/]+/, getActualDomain(window));\n}\nexport function closeWindow(win) {\n  try {\n    win.close();\n  } catch (err) {// pass\n  }\n}\nexport function getFrameForWindow(win) {\n  if (isSameDomain(win)) {\n    // @ts-ignore\n    return assertSameDomain(win).frameElement;\n  } // @ts-ignore not an array type, but is iterable so fine\n\n\n  for (var _i21 = 0, _document$querySelect2 = document.querySelectorAll('iframe'); _i21 < _document$querySelect2.length; _i21++) {\n    var frame = _document$querySelect2[_i21];\n\n    if (frame && frame.contentWindow && frame.contentWindow === win) {\n      return frame;\n    }\n  }\n}","export var PROTOCOL = {\n  MOCK: 'mock:',\n  FILE: 'file:',\n  ABOUT: 'about:'\n};\nexport var WILDCARD = '*';\nexport var WINDOW_TYPE = {\n  IFRAME: 'iframe',\n  POPUP: 'popup'\n};","// export something to force webpack to see this as an ES module\nexport var TYPES = true;","export default function _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}","export default function _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}","import setPrototypeOf from \"@babel/runtime/helpers/esm/setPrototypeOf\";\nimport isNativeReflectConstruct from \"@babel/runtime/helpers/esm/isNativeReflectConstruct\";\nexport default function _construct(Parent, args, Class) {\n  if (isNativeReflectConstruct()) {\n    _construct = Reflect.construct;\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}","import getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport setPrototypeOf from \"@babel/runtime/helpers/esm/setPrototypeOf\";\nimport isNativeFunction from \"@babel/runtime/helpers/esm/isNativeFunction\";\nimport construct from \"@babel/runtime/helpers/esm/construct\";\nexport default function _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return construct(Class, arguments, getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}","export default function _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}","export function safeIndexOf<T>(collection: ReadonlyArray<T>, item: T): number {\n    for (let i = 0; i < collection.length; i++) {\n        try {\n            if (collection[i] === item) {\n                return i;\n            }\n        } catch (err) {\n            // pass\n        }\n    }\n\n    return -1;\n}\n\nexport function noop(...args: ReadonlyArray<unknown>): void { // eslint-disable-line @typescript-eslint/no-unused-vars\n    // pass\n}\n","import { isWindow, isWindowClosed } from 'cross-domain-utils';\n\nimport { hasNativeWeakMap } from './native';\nimport { noop, safeIndexOf } from './util';\n\nexport class CrossDomainSafeWeakMap<K extends Record<string, any>, V extends unknown> {\n    name: string;\n    weakmap: WeakMap<K, V> | null | undefined;\n    keys: Array<K>;\n    values: Array<V>;\n\n    constructor() {\n        // eslint-disable-next-line no-bitwise\n        this.name = `__weakmap_${ Math.random() * 1e9 >>> 0 }__`;\n\n        if (hasNativeWeakMap()) {\n            try {\n                this.weakmap = new WeakMap();\n            } catch (err) { // pass\n            }\n        }\n\n        this.keys = [];\n        this.values = [];\n    }\n\n    _cleanupClosedWindows(): void {\n        const weakmap = this.weakmap;\n        const keys = this.keys;\n\n        for (let i = 0; i < keys.length; i++) {\n            const value = keys[i];\n\n            // @ts-ignore `isWindowClosed` takes window which V is not\n            if (isWindow(value) && isWindowClosed(value)) {\n                if (weakmap) {\n                    try {\n                        weakmap.delete(value);\n                    } catch (err) { // pass\n                    }\n                }\n\n                keys.splice(i, 1);\n                this.values.splice(i, 1);\n                i -= 1;\n            }\n        }\n    }\n\n    isSafeToReadWrite(key: K): boolean {\n        if (isWindow(key)) {\n            return false;\n        }\n\n        try {\n            noop(key && key.self);\n            noop(key && key[this.name]);\n        } catch (err) {\n            return false;\n        }\n\n        return true;\n    }\n\n    set(key: K, value: V): void {\n        if (!key) {\n            throw new Error(`WeakMap expected key`);\n        }\n\n        const weakmap = this.weakmap;\n\n        if (weakmap) {\n            try {\n                weakmap.set(key, value);\n            } catch (err) {\n                delete this.weakmap;\n            }\n        }\n\n        if (this.isSafeToReadWrite(key)) {\n            try {\n                const name = this.name;\n                const entry = key[name];\n\n                if (entry && entry[0] === key) {\n                    entry[1] = value;\n                } else {\n                    Object.defineProperty(key, name, {\n                        value:    [ key, value ],\n                        writable: true\n                    });\n                }\n\n                return;\n            } catch (err) { // pass\n            }\n        }\n\n        this._cleanupClosedWindows();\n\n        const keys = this.keys;\n        const values = this.values;\n        const index = safeIndexOf(keys, key);\n\n        if (index === -1) {\n            keys.push(key);\n            values.push(value);\n        } else {\n            values[index] = value;\n        }\n    }\n\n    get(key: K): V | void {\n        if (!key) {\n            throw new Error(`WeakMap expected key`);\n        }\n\n        const weakmap = this.weakmap;\n\n        if (weakmap) {\n            try {\n                if (weakmap.has(key)) {\n                    return weakmap.get(key);\n                }\n            } catch (err) {\n                delete this.weakmap;\n            }\n        }\n\n        if (this.isSafeToReadWrite(key)) {\n            try {\n                const entry = key[this.name];\n\n                if (entry && entry[0] === key) {\n                    return entry[1];\n                }\n\n                return;\n            } catch (err) { // pass\n            }\n        }\n\n        this._cleanupClosedWindows();\n\n        const keys = this.keys;\n        const index = safeIndexOf(keys, key);\n\n        if (index === -1) {\n            return;\n        }\n\n        return this.values[index];\n    }\n\n    delete(key: K): void {\n        if (!key) {\n            throw new Error(`WeakMap expected key`);\n        }\n\n        const weakmap = this.weakmap;\n\n        if (weakmap) {\n            try {\n                weakmap.delete(key);\n            } catch (err) {\n                delete this.weakmap;\n            }\n        }\n\n        if (this.isSafeToReadWrite(key)) {\n            try {\n                const entry = key[this.name];\n\n                if (entry && entry[0] === key) {\n                    entry[0] = entry[1] = undefined;\n                }\n            } catch (err) { // pass\n            }\n        }\n\n        this._cleanupClosedWindows();\n\n        const keys = this.keys;\n        const index = safeIndexOf(keys, key);\n\n        if (index !== -1) {\n            keys.splice(index, 1);\n            this.values.splice(index, 1);\n        }\n    }\n\n    has(key: K): boolean {\n        if (!key) {\n            throw new Error(`WeakMap expected key`);\n        }\n\n        const weakmap = this.weakmap;\n\n        if (weakmap) {\n            try {\n                if (weakmap.has(key)) {\n                    return true;\n                }\n            } catch (err) {\n                delete this.weakmap;\n            }\n        }\n\n        if (this.isSafeToReadWrite(key)) {\n            try {\n                const entry = key[this.name];\n\n                if (entry && entry[0] === key) {\n                    return true;\n                }\n\n                return false;\n            } catch (err) { // pass\n            }\n        }\n\n        this._cleanupClosedWindows();\n\n        const index = safeIndexOf(this.keys, key);\n        return index !== -1;\n    }\n\n    getOrSet(key: K, getter: () => V): V {\n        if (this.has(key)) {\n            // @ts-ignore\n            return this.get(key);\n        }\n\n        const value = getter();\n        this.set(key, value);\n        return value;\n    }\n\n}\n","/* eslint max-lines: 0 */\nimport { ZalgoPromise } from 'zalgo-promise';\nimport { WeakMap } from 'cross-domain-safe-weakmap/src';\n\nimport type { CancelableType } from './types';\n\nexport function getFunctionName<T extends (...args: Array<any>) => any>(fn: T): string {\n    // @ts-ignore - cant infer this all from T\n    return fn.name || fn.__name__ || fn.displayName || 'anonymous';\n}\nexport function setFunctionName<T extends (...args: Array<any>) => any>(fn: T, name: string): T {\n    try {\n        // @ts-ignore this should be readonly\n        delete fn.name;\n        // @ts-ignore this should be readonly\n        fn.name = name;\n    } catch (err) { // pass\n    }\n\n    // @ts-ignore this should be readonly\n    fn.__name__ = fn.displayName = name;\n    return fn;\n}\nexport function base64encode(str: string): string {\n    if (typeof btoa === 'function') {\n        return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, (m, p1) => {\n            return String.fromCharCode(parseInt(p1, 16));\n        })).replace(/[=]/g, '');\n    }\n\n    if (typeof Buffer !== 'undefined') {\n        return Buffer.from(str, 'utf8').toString('base64').replace(/[=]/g, '');\n    }\n\n    throw new Error(`Can not find window.btoa or Buffer`);\n}\nexport function base64decode(str: string): string {\n    if (typeof atob === 'function') {\n        return decodeURIComponent(Array.prototype.map.call(atob(str), c => {\n            // eslint-disable-next-line prefer-template\n            return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n        }).join(''));\n    }\n\n    if (typeof Buffer !== 'undefined') {\n        return Buffer.from(str, 'base64').toString('utf8');\n    }\n\n    throw new Error(`Can not find window.atob or Buffer`);\n}\nexport function uniqueID(): string {\n    const chars = '0123456789abcdef';\n    const randomID = 'xxxxxxxxxx'.replace(/./g, () => {\n        return chars.charAt(Math.floor(Math.random() * chars.length));\n    });\n    const timeID = base64encode(new Date().toISOString().slice(11, 19).replace('T', '.')).replace(/[^a-zA-Z0-9]/g, '').toLowerCase();\n    return `uid_${ randomID }_${ timeID }`;\n}\nexport function getGlobal(): Record<string, any> {\n    if (typeof window !== 'undefined') {\n        return window;\n    }\n\n    if (typeof global !== 'undefined') {\n        return global;\n    }\n\n    // @ts-ignore - globals\n    if (typeof __GLOBAL__ !== 'undefined') {\n        // @ts-ignore - globals\n        return __GLOBAL__;\n    }\n\n    throw new Error(`No global found`);\n}\n\nlet objectIDs: any;\nexport function getObjectID(obj: Record<string, any>): string {\n    objectIDs = objectIDs || new WeakMap();\n\n    if (obj === null || obj === undefined || typeof obj !== 'object' && typeof obj !== 'function') {\n        throw new Error(`Invalid object`);\n    }\n\n    let uid = objectIDs.get(obj);\n\n    if (!uid) {\n        uid = `${ typeof obj }:${ uniqueID() }`;\n        objectIDs.set(obj, uid);\n    }\n\n    return uid;\n}\n\nfunction serializeArgs<T>(args: ReadonlyArray<T>): string {\n    try {\n        return JSON.stringify(Array.prototype.slice.call(args), (subkey, val) => {\n            if (typeof val === 'function') {\n                return `memoize[${ getObjectID(val) }]`;\n            }\n\n            return val;\n        });\n    } catch (err) {\n        throw new Error(`Arguments not serializable -- can not be used to memoize`);\n    }\n}\n\nexport function getEmptyObject(): Record<string, undefined> {\n    return {};\n}\ntype MemoizeOptions = {\n    name?: string;\n    time?: number;\n    thisNamespace?: boolean;\n};\n\nconst getDefaultMemoizeOptions = (): MemoizeOptions => {\n    return {};\n};\n\nexport type Memoized<F> = F & {\n    reset: () => void;\n};\nlet memoizeGlobalIndex = 0;\nlet memoizeGlobalIndexValidFrom = 0;\nexport function memoize<F extends (...args: Array<any>) => any>(method: F, options: MemoizeOptions = getDefaultMemoizeOptions()): Memoized<F> {\n    const {\n        thisNamespace = false,\n        time: cacheTime\n    } = options;\n    let simpleCache: any;\n    let thisCache: any;\n    let memoizeIndex = memoizeGlobalIndex;\n    memoizeGlobalIndex += 1;\n\n    const memoizedFunction = function memoizedFunction(...args: any): unknown {\n        if (memoizeIndex < memoizeGlobalIndexValidFrom) {\n            simpleCache = null;\n            thisCache = null;\n            memoizeIndex = memoizeGlobalIndex;\n            memoizeGlobalIndex += 1;\n        }\n\n        let cache;\n\n        if (thisNamespace) {\n            thisCache = thisCache || new WeakMap();\n            // @ts-ignore this is any\n            cache = thisCache.getOrSet(this, getEmptyObject);\n        } else {\n            cache = simpleCache = simpleCache || {};\n        }\n\n        const cacheKey = serializeArgs(args);\n        let cacheResult = cache[cacheKey];\n\n        if (cacheResult && cacheTime && Date.now() - cacheResult.time < cacheTime) {\n            delete cache[cacheKey];\n            cacheResult = null;\n        }\n\n        if (cacheResult) {\n            return cacheResult.value;\n        }\n\n        const time = Date.now();\n        // @ts-ignore\n        const value = method.apply(this, arguments);\n        cache[cacheKey] = {\n            time,\n            value\n        };\n        return value;\n    };\n\n    memoizedFunction.reset = () => {\n        simpleCache = null;\n        thisCache = null;\n    };\n\n    // @ts-ignore\n    const result: F = memoizedFunction;\n    // @ts-ignore\n    return setFunctionName(result, `${ options.name || getFunctionName(method) }::memoized`);\n}\n\nmemoize.clear = () => {\n    memoizeGlobalIndexValidFrom = memoizeGlobalIndex;\n};\n\nexport function promiseIdentity<T extends unknown>(item: ZalgoPromise<T> | T): ZalgoPromise<T> {\n    return ZalgoPromise.resolve(item);\n}\nexport function memoizePromise<R>(method: (...args: ReadonlyArray<any>) => ZalgoPromise<R>): (...args: ReadonlyArray<any>) => ZalgoPromise<R> {\n    let cache: Record<string, any> = {};\n\n    function memoizedPromiseFunction(...args: ReadonlyArray<any>): ZalgoPromise<R> {\n        const key: string = serializeArgs(args);\n\n        if (cache.hasOwnProperty(key)) {\n            return cache[key];\n        }\n\n        // @ts-ignore\n        cache[key] = ZalgoPromise.try(() => method.apply(this, arguments)).finally(() => {\n            delete cache[key];\n        });\n        return cache[key];\n    }\n\n    memoizedPromiseFunction.reset = () => {\n        cache = {};\n    };\n\n    return setFunctionName(memoizedPromiseFunction, `${ getFunctionName(method) }::promiseMemoized`);\n}\ntype PromisifyOptions = {\n    name?: string;\n};\n\nconst getDefaultPromisifyOptions = (): PromisifyOptions => {\n    return {};\n};\n\nexport function promisify<R>(method: (...args: ReadonlyArray<any>) => R, options: PromisifyOptions = getDefaultPromisifyOptions()): (...args: ReadonlyArray<any>) => ZalgoPromise<R> {\n    function promisifiedFunction(): ZalgoPromise<R> {\n        // @ts-ignore\n        return ZalgoPromise.try(method, this, arguments);\n    }\n\n    if (options.name) {\n        promisifiedFunction.displayName = `${ options.name }:promisified`;\n    }\n\n    return setFunctionName(promisifiedFunction, `${ getFunctionName(method) }::promisified`);\n}\nexport function inlineMemoize<R>(method: (...args: ReadonlyArray<any>) => R, logic: (...args: ReadonlyArray<any>) => R, args: ReadonlyArray<any> = []): R { // eslint-disable-line no-shadow\n    // @ts-ignore\n    const cache: Record<string, R> = method.__inline_memoize_cache__ = method.__inline_memoize_cache__ || {};\n    const key = serializeArgs(args);\n\n    if (cache.hasOwnProperty(key)) {\n        return cache[key];\n    }\n\n    const result = cache[key] = logic(...args);\n    return result;\n}\n\nexport function noop(...args: ReadonlyArray<unknown>): void { // eslint-disable-line @typescript-eslint/no-unused-vars\n    // pass\n}\n\nexport function once(method: (...args: Array<any>) => any): (...args: Array<any>) => any {\n    let called = false;\n\n    const onceFunction = function (): unknown {\n        if (!called) {\n            called = true;\n            // @ts-ignore\n            return method.apply(this, arguments);\n        }\n    };\n\n    return setFunctionName(onceFunction, `${ getFunctionName(method) }::once`);\n}\nexport function hashStr(str: string): number {\n    let hash = 0;\n\n    for (let i = 0; i < str.length; i++) {\n        hash += str[i].charCodeAt(0) * Math.pow(i % 10 + 1, 5);\n    }\n\n    return Math.floor(Math.pow(Math.sqrt(hash), 5));\n}\nexport function strHashStr(str: string): string {\n    let hash = '';\n\n    for (let i = 0; i < str.length; i++) {\n        let total = str[i].charCodeAt(0) * i;\n\n        if (str[i + 1]) {\n            total += str[i + 1].charCodeAt(0) * (i - 1);\n        }\n\n        hash += String.fromCharCode(97 + Math.abs(total) % 26);\n    }\n\n    return hash;\n}\nexport function match(str: string, pattern: RegExp): string | null | undefined {\n    const regmatch = str.match(pattern);\n\n    if (regmatch) {\n        return regmatch[1];\n    }\n}\nexport function awaitKey<T extends unknown>(obj: Record<string, any>, key: string): ZalgoPromise<T> {\n    return new ZalgoPromise((resolve: Function) => {\n        let value = obj[key];\n\n        if (value) {\n            return resolve(value);\n        }\n\n        delete obj[key];\n        Object.defineProperty(obj, key, {\n            configurable: true,\n\n            set(item) {\n                value = item;\n\n                if (value) {\n                    resolve(value);\n                }\n            },\n\n            get(): T {\n                return value;\n            }\n\n        });\n    });\n}\nexport function stringifyError(err: unknown, level = 1): string {\n    if (level >= 3) {\n        return 'stringifyError stack overflow';\n    }\n\n    try {\n        if (!err) {\n            return `<unknown error: ${ Object.prototype.toString.call(err) }>`;\n        }\n\n        if (typeof err === 'string') {\n            return err;\n        }\n\n        if (err instanceof Error) {\n            const stack = err && err.stack;\n            const message = err && err.message;\n\n            if (stack && message) {\n                if (stack.indexOf(message) !== -1) {\n                    return stack;\n                } else {\n                    return `${ message }\\n${ stack }`;\n                }\n            } else if (stack) {\n                return stack;\n            } else if (message) {\n                return message;\n            }\n        }\n\n        // @ts-ignore\n        if (err && err.toString && typeof err.toString === 'function') {\n            // @ts-ignore\n            return err.toString();\n        }\n\n        return Object.prototype.toString.call(err);\n    } catch (newErr) {\n        return `Error while stringifying error: ${ stringifyError(newErr, level + 1) }`;\n    }\n}\nexport function stringifyErrorMessage(err: Error): string {\n    const defaultMessage = `<unknown error: ${ Object.prototype.toString.call(err) }>`;\n\n    if (!err) {\n        return defaultMessage;\n    }\n\n    if (err instanceof Error) {\n        return err.message || defaultMessage;\n    }\n\n    // @ts-ignore\n    if (typeof err.message === 'string') {\n        // @ts-ignore\n        return err.message || defaultMessage;\n    }\n\n    return defaultMessage;\n}\nexport function stringify(item: unknown): string {\n    if (typeof item === 'string') {\n        return item;\n    }\n\n    // @ts-ignore\n    if (item && item.toString && typeof item.toString === 'function') {\n        // @ts-ignore\n        return item.toString();\n    }\n\n    return Object.prototype.toString.call(item);\n}\nexport function domainMatches(hostname: string, domain: string): boolean {\n    hostname = hostname.split('://')[1];\n    const index = hostname.indexOf(domain);\n    return index !== -1 && hostname.slice(index) === domain;\n}\nexport function patchMethod(obj: Record<string, any>, name: string, handler: (...args: Array<any>) => any): void {\n    const original = obj[name];\n\n    obj[name] = function patchedMethod(): unknown {\n        return handler({\n            context:      this,\n            args:         Array.prototype.slice.call(arguments),\n            original,\n            // @ts-ignore\n            callOriginal: () => original.apply(this, arguments)\n        });\n    };\n}\nexport function extend<T extends Record<string, any> | ((...args: Array<any>) => any)>(obj: T, source: Record<string, any>): T {\n    if (!source) {\n        return obj;\n    }\n\n    if (Object.assign) {\n        return Object.assign(obj, source);\n    }\n\n    for (const key in source) {\n        if (source.hasOwnProperty(key)) {\n            // @ts-ignore\n            obj[key] = source[key];\n        }\n    }\n\n    return obj;\n}\nexport function values<T>(obj: Record<string, T>): ReadonlyArray<T> {\n    if (Object.values) {\n        return Object.values(obj);\n    }\n\n    const result: Array<T> = [];\n\n    for (const key in obj) {\n        if (obj.hasOwnProperty(key)) {\n            result.push(obj[key]);\n        }\n    }\n\n    return result;\n}\nexport const memoizedValues: <T>(arg0: Record<string, T>) => ReadonlyArray<T> = memoize(values);\nexport function perc(pixels: number, percentage: number): number {\n    return Math.round(pixels * percentage / 100);\n}\nexport function min(...args: ReadonlyArray<number>): number {\n    return Math.min(...args);\n}\nexport function max(...args: ReadonlyArray<number>): number {\n    return Math.max(...args);\n}\nexport function roundUp(num: number, nearest: number): number {\n    const remainder = num % nearest;\n    return remainder ? num - remainder + nearest : num;\n}\nexport function regexMap<T>(str: string, regexp: RegExp, handler: () => T): ReadonlyArray<T> {\n    const results: T[] = [];\n    // @ts-ignore\n    str.replace(regexp, function regexMapMatcher(item: string) {\n        // @ts-ignore\n        results.push(handler ? handler.apply(null, arguments) : item);\n    });\n    return results;\n}\nexport function svgToBase64(svg: string): string {\n    return `data:image/svg+xml;base64,${ base64encode(svg) }`;\n}\nexport function objFilter<T, R>(obj: Record<string, T>, filter: (arg0: T, arg1: string | null | undefined) => unknown = Boolean): Record<string, R> {\n    const result: Record<string, R> = {};\n\n    for (const key in obj) {\n        if (!obj.hasOwnProperty(key) || !filter(obj[key], key)) {\n            continue;\n        }\n\n        // @ts-ignore expect R but gets T\n        result[key] = obj[key];\n    }\n\n    return result;\n}\nexport function identity<T>(item: T): T {\n    return item;\n}\nexport function regexTokenize(text: string, regexp: RegExp): ReadonlyArray<string> {\n    const result: string[] = [];\n    text.replace(regexp, token => {\n        result.push(token);\n        return '';\n    });\n    return result;\n}\nexport function promiseDebounce<T>(method: () => ZalgoPromise<T> | T, delay = 50): () => ZalgoPromise<T> {\n    let promise: any;\n    let timeout: any;\n\n    const promiseDebounced = function (): ZalgoPromise<T> {\n        if (timeout) {\n            clearTimeout(timeout);\n        }\n\n        const localPromise = promise = promise || new ZalgoPromise();\n        timeout = setTimeout(() => {\n            promise = null;\n            timeout = null;\n            ZalgoPromise.try(method).then((result: T) => {\n                localPromise.resolve(result);\n            }, (err: unknown) => {\n                localPromise.reject(err);\n            });\n        }, delay);\n        return localPromise;\n    };\n\n    return setFunctionName(promiseDebounced, `${ getFunctionName(method) }::promiseDebounced`);\n}\nexport function safeInterval(method: (...args: Array<any>) => any, time: number): {\n    cancel: () => void;\n} {\n    let timeout: any;\n\n    function loop() {\n        timeout = setTimeout(() => {\n            method();\n            loop();\n        }, time);\n    }\n\n    loop();\n    return {\n        cancel() {\n            clearTimeout(timeout);\n        }\n\n    };\n}\nexport function isInteger(str: string): boolean {\n    return Boolean(str.match(/^[0-9]+$/));\n}\nexport function isFloat(str: string): boolean {\n    return Boolean(str.match(/^[0-9]+\\.[0-9]+$/));\n}\nexport function serializePrimitive(value: string | number | boolean): string {\n    return value.toString();\n}\nexport function deserializePrimitive(value: string): string | number | boolean {\n    if (value === 'true') {\n        return true;\n    } else if (value === 'false') {\n        return false;\n    } else if (isInteger(value)) {\n        return parseInt(value, 10);\n    } else if (isFloat(value)) {\n        return parseFloat(value);\n    } else {\n        return value;\n    }\n}\nexport function dotify(obj: Record<string, any>, prefix = '', newobj: Record<string, any> = {}): Record<string, string> {\n    prefix = prefix ? `${ prefix }.` : prefix;\n\n    for (const key in obj) {\n        if (!obj.hasOwnProperty(key) || obj[key] === undefined || obj[key] === null || typeof obj[key] === 'function') {\n            continue;\n        } else if (obj[key] && Array.isArray(obj[key]) && obj[key].length && obj[key].every((val: any) => typeof val !== 'object')) {\n            newobj[`${ prefix }${ key }[]`] = obj[key].join(',');\n        } else if (obj[key] && typeof obj[key] === 'object') {\n            newobj = dotify(obj[key], `${ prefix }${ key }`, newobj);\n        } else {\n            newobj[`${ prefix }${ key }`] = serializePrimitive(obj[key]);\n        }\n    }\n\n    return newobj;\n}\nexport function undotify(obj: Record<string, string>): Record<string, any> {\n    const result: Record<string, any> = {};\n\n    for (let key in obj) {\n        if (!obj.hasOwnProperty(key) || typeof obj[key] !== 'string') {\n            continue;\n        }\n\n        let value: any = obj[key];\n\n        if (key.match(/^.+\\[\\]$/)) {\n            key = key.slice(0, -2);\n            value = value.split(',').map(deserializePrimitive);\n        } else {\n            value = deserializePrimitive(value);\n        }\n\n        let keyResult = result;\n        const parts = key.split('.');\n\n        for (let i = 0; i < parts.length; i++) {\n            const part = parts[i];\n            const isLast = i + 1 === parts.length;\n            const isIndex = !isLast && isInteger(parts[i + 1]);\n\n            if (part === 'constructor' || part === 'prototype' || part === '__proto__') {\n                throw new Error(`Disallowed key: ${ part }`);\n            }\n\n            if (isLast) {\n                keyResult[part] = value;\n            } else {\n                keyResult = keyResult[part] = keyResult[part] || (isIndex ? [] : {});\n            }\n        }\n    }\n\n    return result;\n}\nexport type EventEmitterType = {\n    on: (eventName: string, handler: (...args: Array<any>) => any) => CancelableType;\n    once: (eventName: string, handler: (...args: Array<any>) => any) => CancelableType;\n    trigger: (eventName: string, ...args: ReadonlyArray<unknown>) => ZalgoPromise<void>;\n    triggerOnce: (eventName: string, ...args: ReadonlyArray<unknown>) => ZalgoPromise<void>;\n    reset: () => void;\n};\nexport function eventEmitter(): EventEmitterType {\n    const triggered = {};\n    let handlers = {};\n    const emitter = {\n        on(eventName: string, handler: (...args: Array<any>) => any): CancelableType {\n            // @ts-ignore\n            const handlerList = handlers[eventName] = handlers[eventName] || [];\n            handlerList.push(handler);\n            let cancelled = false;\n            return {\n                cancel() {\n                    if (!cancelled) {\n                        cancelled = true;\n                        handlerList.splice(handlerList.indexOf(handler), 1);\n                    }\n                }\n\n            };\n        },\n\n        once(eventName: string, handler: (...args: Array<any>) => any): CancelableType {\n            const listener = emitter.on(eventName, () => {\n                listener.cancel();\n                handler();\n            });\n            return listener;\n        },\n\n        trigger(eventName: string, ...args: ReadonlyArray<unknown>): ZalgoPromise<void> {\n            // @ts-ignore\n            const handlerList = handlers[eventName];\n            const promises = [];\n\n            if (handlerList) {\n                for (const handler of handlerList) {\n                    promises.push(ZalgoPromise.try(() => handler(...args)));\n                }\n            }\n\n            return ZalgoPromise.all(promises).then(noop);\n        },\n\n        triggerOnce(eventName: string, ...args: ReadonlyArray<unknown>): ZalgoPromise<void> {\n            // @ts-ignore\n            if (triggered[eventName]) {\n                return ZalgoPromise.resolve();\n            }\n\n            // @ts-ignore\n            triggered[eventName] = true;\n            return emitter.trigger(eventName, ...args);\n        },\n\n        reset() {\n            handlers = {};\n        }\n\n    };\n    return emitter;\n}\nexport function camelToDasherize(string: string): string {\n    return string.replace(/([A-Z])/g, g => {\n        return `-${ g.toLowerCase() }`;\n    });\n}\nexport function dasherizeToCamel(string: string): string {\n    return string.replace(/-([a-z])/g, g => {\n        return g[1].toUpperCase();\n    });\n}\nexport function capitalizeFirstLetter(string: string): string {\n    return string.charAt(0).toUpperCase() + string.slice(1).toLowerCase();\n}\nexport function get(item: Record<string, any>, path: string, def: unknown): unknown {\n    if (!path) {\n        return def;\n    }\n\n    const pathParts = path.split('.');\n\n    // Loop through each section of our key path\n    for (let i = 0; i < pathParts.length; i++) {\n        // If we have an object, we can get the key\n        if (typeof item === 'object' && item !== null) {\n            item = item[pathParts[i]]; // Otherwise, we should return the default (undefined if not provided)\n        } else {\n            return def;\n        }\n    }\n\n    // If our final result is undefined, we should return the default\n    return item === undefined ? def : item;\n}\nexport function safeTimeout(method: (...args: Array<any>) => any, time: number) : void{\n    const interval = safeInterval(() => {\n        time -= 100;\n\n        if (time <= 0) {\n            interval.cancel();\n            method();\n        }\n    }, 100);\n}\nexport function defineLazyProp<T>(obj: Record<string, any> | ReadonlyArray<unknown>, key: string | number, getter: () => T): void {\n    if (Array.isArray(obj)) {\n        if (typeof key !== 'number') {\n            throw new TypeError(`Array key must be number`);\n        }\n    } else if (typeof obj === 'object' && obj !== null) {\n        if (typeof key !== 'string') {\n            throw new TypeError(`Object key must be string`);\n        }\n    }\n\n    Object.defineProperty(obj, key, {\n        configurable: true,\n        enumerable:   true,\n        get:          () => {\n            // @ts-ignore\n            delete obj[key];\n            const value = getter();\n            // @ts-ignore\n            obj[key] = value;\n            return value;\n        },\n        set: (value: T) => {\n            // @ts-ignore\n            delete obj[key];\n            // @ts-ignore\n            obj[key] = value;\n        }\n    });\n}\nexport function arrayFrom<T>(item: Iterable<T>): ReadonlyArray<T> {\n    return Array.prototype.slice.call(item);\n}\nexport function isObject(item: unknown): boolean {\n    return typeof item === 'object' && item !== null;\n}\nexport function isObjectObject(obj: unknown): boolean {\n    return isObject(obj) && Object.prototype.toString.call(obj) === '[object Object]';\n}\nexport function isPlainObject(obj: unknown): boolean {\n    if (!isObjectObject(obj)) {\n        return false;\n    }\n\n    // @ts-ignore\n    const constructor = obj.constructor;\n\n    if (typeof constructor !== 'function') {\n        return false;\n    }\n\n    const prototype = constructor.prototype;\n\n    if (!isObjectObject(prototype)) {\n        return false;\n    }\n\n    if (!prototype.hasOwnProperty('isPrototypeOf')) {\n        return false;\n    }\n\n    return true;\n}\nexport function replaceObject<T extends ReadonlyArray<unknown> | Record<string, any>>(item: T, replacer: (arg0: unknown, arg1: string | number, arg2: string) => unknown, fullKey = ''): T {\n    if (Array.isArray(item)) {\n        const length = item.length;\n        const result: Array<unknown> = [];\n\n        for (let i = 0; i < length; i++) {\n            defineLazyProp(result, i, () => {\n                const itemKey = fullKey ? `${ fullKey }.${ i }` : `${ i }`;\n                const el = item[i];\n                let child = replacer(el, i, itemKey);\n\n                if (isPlainObject(child) || Array.isArray(child)) {\n                    // @ts-ignore\n                    child = replaceObject(child, replacer, itemKey);\n                }\n\n                return child;\n            });\n        }\n\n        // @ts-ignore\n        return result;\n    } else if (isPlainObject(item)) {\n        const result = {};\n\n        for (const key in item) {\n            if (!item.hasOwnProperty(key)) {\n                continue;\n            }\n\n            defineLazyProp(result, key, () => {\n                const itemKey = fullKey ? `${ fullKey }.${ key }` : `${ key }`;\n                const el = item[key];\n                let child = replacer(el, key, itemKey);\n\n                if (isPlainObject(child) || Array.isArray(child)) {\n                    // @ts-ignore\n                    child = replaceObject(child, replacer, itemKey);\n                }\n\n                return child;\n            });\n        }\n\n        // @ts-ignore\n        return result;\n    } else {\n        throw new Error(`Pass an object or array`);\n    }\n}\nexport function copyProp(source: Record<string, any>, target: Record<string, any>, name: string, def: unknown): void {\n    if (source.hasOwnProperty(name)) {\n        const descriptor = Object.getOwnPropertyDescriptor(source, name);\n        // @ts-ignore\n        Object.defineProperty(target, name, descriptor);\n    } else {\n        target[name] = def;\n    }\n}\ntype RegexResultType = {\n    text: string;\n    groups: ReadonlyArray<string>;\n    start: number;\n    end: number;\n    length: number;\n    replace: (text: string) => string;\n};\nexport function regex(pattern: string | RegExp, string: string, start = 0): RegexResultType | null | undefined {\n    if (typeof pattern === 'string') {\n        // eslint-disable-next-line security/detect-non-literal-regexp\n        pattern = new RegExp(pattern);\n    }\n\n    const result = string.slice(start).match(pattern);\n\n    if (!result) {\n        return;\n    }\n\n    const index: number = result.index as number;\n    const regmatch = result[0];\n    return {\n        text:   regmatch,\n        groups: result.slice(1),\n        start:  start + index,\n        end:    start + index + regmatch.length,\n        length: regmatch.length,\n\n        replace(text: string): string {\n            if (!regmatch) {\n                return '';\n            }\n\n            return `${ regmatch.slice(0, start + index) }${ text }${ regmatch.slice(index + regmatch.length) }`;\n        }\n\n    };\n}\nexport function regexAll(pattern: string | RegExp, string: string): ReadonlyArray<RegexResultType> {\n    const matches = [];\n    let start = 0;\n\n    // eslint-disable-next-line no-constant-condition\n    while (true) {\n        const regmatch = regex(pattern, string, start);\n\n        if (!regmatch) {\n            break;\n        }\n\n        matches.push(regmatch);\n        // @ts-ignore\n        start = match.end;\n    }\n\n    return matches;\n}\nexport function isDefined(value: unknown | null | undefined): boolean {\n    return value !== null && value !== undefined;\n}\nexport function cycle(method: (...args: Array<any>) => any): ZalgoPromise<void> {\n    // @ts-ignore - not even sure what to do with this\n    return ZalgoPromise.try(method).then(() => cycle(method));\n}\nexport function debounce<T>(method: (...args: ReadonlyArray<unknown>) => T, time = 100): (...args: ReadonlyArray<unknown>) => void {\n    let timeout: NodeJS.Timeout;\n\n    const debounceWrapper = function () {\n        clearTimeout(timeout);\n        timeout = setTimeout(() => {\n            // @ts-ignore\n            return method.apply(this, arguments);\n        }, time);\n    };\n\n    return setFunctionName(debounceWrapper, `${ getFunctionName(method) }::debounced`);\n}\nexport function isRegex(item: unknown): boolean {\n    return Object.prototype.toString.call(item) === '[object RegExp]';\n}\ntype FunctionProxy<T extends (...args: Array<any>) => any> = (method: T) => T;\nexport const weakMapMemoize: FunctionProxy<any> = <R extends unknown>(method: (arg: any) => R): (...args: ReadonlyArray<any>) => R => {\n    const weakmap = new WeakMap();\n    return function weakmapMemoized(arg: any): R {\n        // @ts-ignore\n        return weakmap.getOrSet(arg, () => method.call(this, arg));\n    };\n};\ntype FunctionPromiseProxy<R extends unknown, T extends (...args: ReadonlyArray<unknown>) => ZalgoPromise<R>> = (arg0: T) => T;\nexport const weakMapMemoizePromise: FunctionPromiseProxy<any, any> = <R extends unknown>(method: (arg: any) => ZalgoPromise<R>): (...args: ReadonlyArray<any>) => ZalgoPromise<R> => {\n    const weakmap = new WeakMap();\n    return function weakmapMemoizedPromise(arg: any): ZalgoPromise<R> {\n        // @ts-ignore\n        return weakmap.getOrSet(arg, () => method.call(this, arg).finally(() => {\n            weakmap.delete(arg);\n        }));\n    };\n};\nexport function getOrSet<T extends unknown>(obj: Record<string, any>, key: string, getter: () => T): T {\n    if (obj.hasOwnProperty(key)) {\n        return obj[key];\n    }\n\n    const val = getter();\n    obj[key] = val;\n    return val;\n}\nexport type CleanupType = {\n    set: <T extends unknown>(arg0: string, arg1: T) => T;\n    register: (arg0: (...args: Array<any>) => any) => void;\n    all: (err?: unknown) => ZalgoPromise<void>;\n};\nexport function cleanup(obj: Record<string, any>): CleanupType {\n    const tasks: any = [];\n    let cleaned = false;\n    let cleanErr: any;\n    const cleaner = {\n        set<T extends unknown>(name: string, item: T): T {\n            if (!cleaned) {\n                obj[name] = item;\n                cleaner.register(() => {\n                    delete obj[name];\n                });\n            }\n\n            return item;\n        },\n\n        register(method: (...args: Array<any>) => any) {\n            if (cleaned) {\n                method(cleanErr);\n            } else {\n                tasks.push(once(() => method(cleanErr)));\n            }\n        },\n\n        all(err?: unknown): ZalgoPromise<void> {\n            cleanErr = err;\n            const results = [];\n            cleaned = true;\n\n            while (tasks.length) {\n                const task = tasks.shift();\n                results.push(task());\n            }\n\n            return ZalgoPromise.all(results).then(noop);\n        }\n\n    };\n    return cleaner;\n}\nexport function tryCatch<T>(fn: () => T): {\n    result: T;\n    error: void;\n} | {\n    result: T | undefined;\n    error: unknown;\n} {\n    let result;\n    let error;\n\n    try {\n        result = fn();\n    } catch (err) {\n        error = err;\n    }\n\n    return {\n        result,\n        error\n    };\n}\nexport function removeFromArray<X, T extends Array<X>>(arr: T, item: X): void {\n    const index = arr.indexOf(item);\n\n    if (index !== -1) {\n        arr.splice(index, 1);\n    }\n}\nexport function assertExists<T>(name: string, thing: void | null | T): T {\n    if (thing === null || typeof thing === 'undefined') {\n        throw new Error(`Expected ${ name } to be present`);\n    }\n\n    return thing;\n}\nexport function unique(arr: ReadonlyArray<string>): ReadonlyArray<string> {\n    const result: Record<string, boolean> = {};\n\n    for (const item of arr) {\n        result[item] = true;\n    }\n\n    return Object.keys(result);\n}\nexport const constHas = <X extends string | boolean | number, T extends Record<string, X>>(constant: T, value: X): boolean => {\n    return memoizedValues(constant).indexOf(value) !== -1;\n};\nexport function dedupeErrors<T>(handler: (arg0: unknown) => T): (arg0: unknown) => T | void {\n    const seenErrors: unknown[] = [];\n    const seenStringifiedErrors: Record<string, unknown> = {};\n    return err => {\n        if (seenErrors.indexOf(err) !== -1) {\n            return;\n        }\n\n        seenErrors.push(err);\n        const stringifiedError = stringifyError(err);\n\n        if (seenStringifiedErrors[stringifiedError]) {\n            return;\n        }\n\n        seenStringifiedErrors[stringifiedError] = true;\n        return handler(err);\n    };\n}\nexport class ExtendableError extends Error {\n    constructor(message: string) {\n        super(message);\n        // eslint-disable-next-line unicorn/custom-error-definition\n        this.name = this.constructor.name;\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, this.constructor);\n        } else {\n            this.stack = new Error(message).stack;\n        }\n    }\n\n}\n","export function hasNativeWeakMap(): boolean {\n    if (typeof WeakMap === 'undefined') {\n        return false;\n    }\n\n    if (typeof Object.freeze === 'undefined') {\n        return false;\n    }\n\n    try {\n        const testWeakMap = new WeakMap();\n        const testKey = {};\n        const testValue = '__testvalue__';\n        Object.freeze(testKey);\n        testWeakMap.set(testKey, testValue);\n\n        if (testWeakMap.get(testKey) === testValue) {\n            return true;\n        }\n\n        return false;\n    } catch (err) {\n        return false;\n    }\n}\n","export default function _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}","export const KEY_CODES = {\n    ENTER: 13,\n    SPACE: 32\n};\nexport const ATTRIBUTES = {\n    UID: 'data-uid'\n};\nexport const UID_HASH_LENGTH = 30;\n","/* eslint max-lines: off */\nimport { ZalgoPromise } from 'zalgo-promise';\nimport type { SameDomainWindowType, CrossDomainWindowType } from 'cross-domain-utils';\nimport { linkFrameWindow, isWindowClosed, assertSameDomain } from 'cross-domain-utils'; // eslint-disable-line no-duplicate-imports\nimport { WeakMap } from 'cross-domain-safe-weakmap';\n\nimport { inlineMemoize, memoize, noop, stringify, capitalizeFirstLetter, once, extend, safeInterval, uniqueID, arrayFrom, ExtendableError, strHashStr } from './util';\nimport { isDevice } from './device';\nimport { KEY_CODES, ATTRIBUTES, UID_HASH_LENGTH } from './constants';\nimport type { CancelableType } from './types';\n\ntype ElementRefType = string | HTMLElement;\nexport function getBody(): HTMLBodyElement | HTMLElement {\n    // eslint-disable-next-line compat/compat\n    const body = document.body;\n\n    if (!body) {\n        throw new Error(`Body element not found`);\n    }\n\n    return body;\n}\nexport function isDocumentReady(): boolean {\n    // eslint-disable-next-line compat/compat\n    return Boolean(document.body) && document.readyState === 'complete';\n}\nexport function isDocumentInteractive(): boolean {\n    // eslint-disable-next-line compat/compat\n    return Boolean(document.body) && document.readyState === 'interactive';\n}\nexport function urlEncode(str: string): string {\n    return encodeURIComponent(str);\n}\nexport function waitForWindowReady(): ZalgoPromise<void> {\n    return inlineMemoize(waitForWindowReady, (): ZalgoPromise<void> => {\n        return new ZalgoPromise((resolve: Function) => {\n            if (isDocumentReady()) {\n                resolve();\n            }\n\n            window.addEventListener('load', () => resolve());\n        });\n    });\n}\ntype WaitForDocumentReady = () => ZalgoPromise<void>;\nexport const waitForDocumentReady: WaitForDocumentReady = memoize(() => {\n    return new ZalgoPromise((resolve: Function) => {\n        if (isDocumentReady() || isDocumentInteractive()) {\n            return resolve();\n        }\n\n        const interval = setInterval(() => {\n            if (isDocumentReady() || isDocumentInteractive()) {\n                clearInterval(interval);\n                return resolve();\n            }\n        }, 10);\n    });\n});\nexport function waitForDocumentBody(): ZalgoPromise<HTMLElement | HTMLBodyElement> {\n    return ZalgoPromise.try(() => {\n        if (document.body) {\n            return document.body;\n        }\n\n        return waitForDocumentReady().then(() => {\n            if (document.body) {\n                return document.body;\n            }\n\n            throw new Error('Document ready but document.body not present');\n        });\n    });\n}\nexport function parseQuery(queryString: string): Record<string, any> {\n    return inlineMemoize(parseQuery, (): Record<string, any> => {\n        const params = {};\n\n        if (!queryString) {\n            return params;\n        }\n\n        if (queryString.indexOf('=') === -1) {\n            return params;\n        }\n\n        for (let pair of queryString.split('&')) {\n            // @ts-ignore - should we actually be using a temp variable here. this seems strange\n            pair = pair.split('=');\n\n            if (pair[0] && pair[1]) {\n                // @ts-ignore - params is untyped\n                params[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\n            }\n        }\n\n        return params;\n    }, [ queryString ]);\n}\nexport function getQueryParam(name: string): string {\n    return parseQuery(window.location.search.slice(1))[name];\n}\nexport function urlWillRedirectPage(url: string): boolean {\n    if (url.indexOf('#') === -1) {\n        return true;\n    }\n\n    if (url.indexOf('#') === 0) {\n        return false;\n    }\n\n    if (url.split('#')[0] === window.location.href.split('#')[0]) {\n        return false;\n    }\n\n    return true;\n}\nexport type Query = Record<string, boolean | string>;\nexport function formatQuery(obj: Query = {}): string {\n    return Object.keys(obj).filter(key => {\n        return typeof obj[key] === 'string' || typeof obj[key] === 'boolean';\n    }).map(key => {\n        const val = obj[key];\n\n        if (typeof val !== 'string' && typeof val !== 'boolean') {\n            throw new TypeError(`Invalid type for query`);\n        }\n\n        return `${ urlEncode(key) }=${ urlEncode(val.toString()) }`;\n    }).join('&');\n}\nexport function extendQuery(originalQuery: string, props: Query = {}): string {\n    if (!props || !Object.keys(props).length) {\n        return originalQuery;\n    }\n\n    return formatQuery({ ...parseQuery(originalQuery),\n        ...props\n    });\n}\nexport function extendUrl(url: string, options: {\n    query?: Query;\n    hash?: Query;\n}): string {\n    const query = options.query || {};\n    const hash = options.hash || {};\n    let originalUrl;\n    let originalQuery;\n    let originalHash;\n    [ originalUrl, originalHash ] = url.split('#');\n    [ originalUrl, originalQuery ] = originalUrl.split('?');\n    const queryString = extendQuery(originalQuery, query);\n    const hashString = extendQuery(originalHash, hash);\n\n    if (queryString) {\n        originalUrl = `${ originalUrl }?${ queryString }`;\n    }\n\n    if (hashString) {\n        originalUrl = `${ originalUrl }#${ hashString }`;\n    }\n\n    return originalUrl;\n}\nexport function redirect(url: string, win: CrossDomainWindowType = window): ZalgoPromise<void> {\n    // @ts-upgrade TODO: - Need to get in zalgo promise defs\n    return new ZalgoPromise((resolve: Function) => {\n        // @ts-ignore\n        win.location = url;\n\n        if (!urlWillRedirectPage(url)) {\n            resolve();\n        }\n    });\n}\nexport function hasMetaViewPort(): boolean {\n    const meta = document.querySelector('meta[name=viewport]');\n\n    if (isDevice() && window.screen.width < 660 && !meta) {\n        return false;\n    }\n\n    return true;\n}\nexport function isElementVisible(el: HTMLElement): boolean {\n    return Boolean(el.offsetWidth || el.offsetHeight || el.getClientRects().length);\n}\nexport function getPerformance(): Performance | null | undefined {\n    return inlineMemoize(getPerformance, (): Performance | null | undefined => {\n        const performance = window.performance;\n\n        if (performance && performance.now && performance.timing && performance.timing.connectEnd && performance.timing.navigationStart && Math.abs(performance.now() - Date.now()) > 1000 && performance.now() - (performance.timing.connectEnd - performance.timing.navigationStart) > 0) {\n            return performance;\n        }\n    });\n}\nexport function enablePerformance(): boolean {\n    return Boolean(getPerformance());\n}\nexport function getPageRenderTime(): ZalgoPromise<number | null | undefined> {\n    return waitForDocumentReady().then(() => {\n        const performance = getPerformance();\n\n        if (!performance) {\n            return;\n        }\n\n        const timing = performance.timing;\n\n        if (timing.connectEnd && timing.domInteractive) {\n            return timing.domInteractive - timing.connectEnd;\n        }\n    });\n}\nexport function htmlEncode(html = ''): string {\n    return html.toString().replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/'/g, '&#39;').replace(/\\//g, '&#x2F;');\n}\nexport function isBrowser(): boolean {\n    return typeof window !== 'undefined' && window.location !== undefined;\n}\nexport function querySelectorAll(selector: string, doc: HTMLDocument = window.document): ReadonlyArray<HTMLElement> {\n    return Array.prototype.slice.call(doc.querySelectorAll(selector));\n}\nexport function onClick(element: HTMLElement, handler: (arg0: Event) => void): void {\n    element.addEventListener('touchstart', noop);\n    element.addEventListener('click', handler);\n    element.addEventListener('keypress', (event: Event) => {\n        // @ts-ignore\n        if (event.keyCode === KEY_CODES.ENTER || event.keyCode === KEY_CODES.SPACE) { // eslint-disable-line unicorn/prefer-event-key\n            return handler(event);\n        }\n    });\n}\nexport function getScript({\n    host = window.location.host,\n    path,\n    reverse = false\n}: {\n    host?: string;\n    path: string;\n    reverse?: boolean;\n}): HTMLScriptElement | null | undefined {\n    return inlineMemoize(getScript, (): HTMLScriptElement | null | undefined => {\n        const url = `${ host }${ path }`;\n        const scripts = Array.prototype.slice.call(document.getElementsByTagName('script'));\n\n        if (reverse) {\n            scripts.reverse();\n        }\n\n        for (const script of scripts) {\n            if (!script.src) {\n                continue;\n            }\n\n            const src = script.src.replace(/^https?:\\/\\//, '').split('?')[0];\n\n            if (src === url) {\n                return script;\n            }\n        }\n    }, [ path ]);\n}\nexport function isLocalStorageEnabled(): boolean {\n    return inlineMemoize(isLocalStorageEnabled, () => {\n        try {\n            if (typeof window === 'undefined') {\n                return false;\n            }\n\n            if (window.localStorage) {\n                const value = Math.random().toString();\n                window.localStorage.setItem('__test__localStorage__', value);\n                const result = window.localStorage.getItem('__test__localStorage__');\n                window.localStorage.removeItem('__test__localStorage__');\n\n                if (value === result) {\n                    return true;\n                }\n            }\n        } catch (err) { // pass\n        }\n\n        return false;\n    });\n}\nexport function getBrowserLocales(): Array<{\n    country?: string;\n    lang: string;\n}> {\n    const nav = window.navigator;\n    const locales = nav.languages ? [ ...nav.languages ] : [];\n\n    if (nav.language) {\n        locales.push(nav.language);\n    }\n\n    // @ts-ignore - userLanguage isnt on navigator natively\n    if (nav.userLanguage) {\n        // @ts-ignore - userLanguage isnt on navigator natively\n        locales.push(nav.userLanguage);\n    }\n\n    // @ts-ignore can't guarantee that lang won't be undefined with this logic\n    return locales.map(locale => {\n        if (locale && locale.match(/^[a-z]{2}[-_][A-Z]{2}$/)) {\n            const [ lang, country ] = locale.split(/[-_]/);\n            return {\n                country,\n                lang\n            };\n        }\n\n        if (locale && locale.match(/^[a-z]{2}$/)) {\n            return {\n                lang: locale\n            };\n        }\n\n        return null;\n    }).filter(Boolean);\n}\nexport function appendChild(container: HTMLElement, child: HTMLElement | Text): void {\n    container.appendChild(child);\n}\nexport function isElement(element: unknown): boolean {\n    if (element instanceof window.Element) {\n        return true;\n    }\n\n    // @ts-ignore\n    if (element !== null && typeof element === 'object' && element.nodeType === 1 && typeof element.style === 'object' && typeof element.ownerDocument === 'object') {\n        return true;\n    }\n\n    return false;\n}\nexport function getElementSafe(id: ElementRefType, doc: Document | HTMLElement = document): HTMLElement  | null | undefined {\n    if (isElement(id)) {\n        // @ts-ignore\n        return id;\n    }\n\n    if (typeof id === 'string') {\n        return doc.querySelector(id) as HTMLElement;\n    }\n}\nexport function getElement(id: ElementRefType, doc: Document | HTMLElement = document): HTMLElement {\n    const element = getElementSafe(id, doc);\n\n    if (element) {\n        return element;\n    }\n\n    throw new Error(`Can not find element: ${ stringify(id) }`);\n}\nexport function elementReady(id: ElementRefType): ZalgoPromise<HTMLElement> {\n    // @ts-upgrade TODO: add zalgo promise types\n    return new ZalgoPromise((resolve: Function, reject: Function) => {\n        const name = stringify(id);\n        let el = getElementSafe(id);\n\n        if (el) {\n            return resolve(el);\n        }\n\n        if (isDocumentReady()) {\n            return reject(new Error(`Document is ready and element ${ name } does not exist`));\n        }\n\n        const interval = setInterval(() => {\n            el = getElementSafe(id);\n\n            if (el) {\n                resolve(el);\n                clearInterval(interval);\n                return;\n            }\n\n            if (isDocumentReady()) {\n                clearInterval(interval);\n                return reject(new Error(`Document is ready and element ${ name } does not exist`));\n            }\n        }, 10);\n    });\n}\n// eslint-disable-next-line unicorn/custom-error-definition\nexport class PopupOpenError extends ExtendableError {}\ntype PopupOptions = {\n    name?: string;\n    width?: number;\n    height?: number;\n    top?: number;\n    left?: number;\n    status?: 0 | 1;\n    resizable?: 0 | 1;\n    toolbar?: 0 | 1;\n    menubar?: 0 | 1;\n    scrollbars?: 0 | 1;\n};\nexport function popup(url: string, options?: PopupOptions): CrossDomainWindowType {\n    options = options || {};\n    const {\n        width,\n        height\n    } = options;\n    let top = 0;\n    let left = 0;\n\n    if (width) {\n        if (window.outerWidth) {\n            left = Math.round((window.outerWidth - width) / 2) + window.screenX;\n        } else if (window.screen.width) {\n            left = Math.round((window.screen.width - width) / 2);\n        }\n    }\n\n    if (height) {\n        if (window.outerHeight) {\n            top = Math.round((window.outerHeight - height) / 2) + window.screenY;\n        } else if (window.screen.height) {\n            top = Math.round((window.screen.height - height) / 2);\n        }\n    }\n\n    if (width && height) {\n        options = {\n            top,\n            left,\n            width,\n            height,\n            status:     1,\n            toolbar:    0,\n            menubar:    0,\n            resizable:  1,\n            scrollbars: 1,\n            ...options\n        };\n    }\n\n    const name = options.name || '';\n    delete options.name;\n    // eslint-disable-next-line array-callback-return\n    const params = Object.keys(options).map(key => {\n        // @ts-ignore\n        if (options[key] !== null && options[key] !== undefined) {\n            // @ts-ignore options object is untyped\n            return `${ key }=${ stringify(options[key]) }`;\n        }\n    }).filter(Boolean).join(',');\n    let win: Window | null;\n\n    try {\n        win = window.open(url, name, params) as Window;\n    } catch (err) {\n        throw new PopupOpenError(`Can not open popup window - ${ err.stack || err.message }`);\n    }\n\n    if (isWindowClosed(win)) {\n        const err = new PopupOpenError(`Can not open popup window - blocked`);\n        throw err;\n    }\n\n    window.addEventListener('unload', () => win?.close());\n    return win;\n}\nexport function writeToWindow(win: SameDomainWindowType, html: string): void {\n    try {\n        win.document.open();\n        win.document.write(html);\n        win.document.close();\n    } catch (err) {\n        try {\n            // @ts-ignore\n            win.location = `javascript: document.open(); document.write(${ JSON.stringify(html) }); document.close();`;\n        } catch (err2) { // pass\n        }\n    }\n}\nexport function writeElementToWindow(win: SameDomainWindowType, el: HTMLElement): void {\n    const tag = el.tagName.toLowerCase();\n\n    if (tag !== 'html') {\n        throw new Error(`Expected element to be html, got ${ tag }`);\n    }\n\n    const documentElement = win.document.documentElement;\n\n    // @ts-ignore\n    for (const child of arrayFrom(documentElement.children)) {\n        // @ts-ignore\n        documentElement.removeChild(child);\n    }\n\n    // @ts-ignore - HTMLCollection not assignable to unknown\n    for (const child of arrayFrom(el.children)) {\n        // @ts-ignore\n        documentElement.appendChild(child);\n    }\n}\nexport function setStyle(el: HTMLElement, styleText: string, doc: Document = window.document): void {\n    // @ts-ignore\n    if (el.styleSheet) {\n        // @ts-ignore\n        el.styleSheet.cssText = styleText;\n    } else {\n        el.appendChild(doc.createTextNode(styleText));\n    }\n}\nexport type ElementOptionsType = {\n    style?: Record<string, string>;\n    id?: string;\n    class?: ReadonlyArray<string> | null | undefined;\n    attributes?: Record<string, string>;\n    styleSheet?: string | null | undefined;\n    html?: string | null | undefined;\n};\n\nlet awaitFrameLoadPromises: WeakMap<HTMLIFrameElement, ZalgoPromise<HTMLIFrameElement>>;\nexport function awaitFrameLoad(frame: HTMLIFrameElement): ZalgoPromise<HTMLIFrameElement> {\n    awaitFrameLoadPromises = awaitFrameLoadPromises || new WeakMap();\n\n    if (awaitFrameLoadPromises.has(frame)) {\n        const promise = awaitFrameLoadPromises.get(frame);\n\n        if (promise) {\n            return promise;\n        }\n    }\n\n    const promise = new ZalgoPromise<HTMLIFrameElement>((resolve: Function, reject: Function) => {\n        frame.addEventListener('load', () => {\n            linkFrameWindow(frame);\n            resolve(frame);\n        });\n        frame.addEventListener('error', (err: Event) => {\n            if (frame.contentWindow) {\n                resolve(frame);\n            } else {\n                reject(err);\n            }\n        });\n    });\n    awaitFrameLoadPromises.set(frame, promise);\n    return promise;\n}\n\nexport function awaitFrameWindow(frame: HTMLIFrameElement): ZalgoPromise<CrossDomainWindowType> {\n    return awaitFrameLoad(frame).then((loadedFrame: any) => {\n        if (!loadedFrame.contentWindow) {\n            throw new Error(`Could not find window in iframe`);\n        }\n\n        return loadedFrame.contentWindow;\n    });\n}\n\nconst getDefaultCreateElementOptions = (): ElementOptionsType => {\n    return {};\n};\n\nexport function createElement(tag = 'div', options: ElementOptionsType = getDefaultCreateElementOptions(), container: HTMLElement | null | undefined): HTMLElement { // eslint-disable-line default-param-last\n    tag = tag.toLowerCase();\n    const element = document.createElement(tag);\n\n    if (options.style) {\n        extend(element.style, options.style);\n    }\n\n    if (options.class) {\n        element.className = options.class.join(' ');\n    }\n\n    if (options.id) {\n        element.setAttribute('id', options.id);\n    }\n\n    if (options.attributes) {\n        for (const key of Object.keys(options.attributes)) {\n            element.setAttribute(key, options.attributes[key]);\n        }\n    }\n\n    if (options.styleSheet) {\n        setStyle(element, options.styleSheet);\n    }\n\n    if (container) {\n        appendChild(container, element);\n    }\n\n    if (options.html) {\n        if (tag === 'iframe') {\n            // @ts-ignore\n            if (!container || !element.contentWindow) {\n                throw new Error(`Iframe html can not be written unless container provided and iframe in DOM`);\n            }\n\n            // @ts-ignore\n            writeToWindow(element.contentWindow, options.html);\n        } else {\n            element.innerHTML = options.html;\n        }\n    }\n\n    return element;\n}\ntype StringMap = Record<string, string>;\nexport type IframeElementOptionsType = {\n    style?: StringMap;\n    class?: ReadonlyArray<string> | null | undefined;\n    attributes?: StringMap;\n    styleSheet?: string | null | undefined;\n    html?: string | null | undefined;\n    url?: string | null | undefined;\n};\n\nconst getDefaultIframeOptions = (): IframeElementOptionsType => {\n    return {};\n};\n\nconst getDefaultStringMap = (): StringMap => {\n    return {};\n};\n\nexport function iframe(options: IframeElementOptionsType = getDefaultIframeOptions(), container: HTMLElement | null | undefined): HTMLIFrameElement { // eslint-disable-line default-param-last\n    const attributes = options.attributes || getDefaultStringMap();\n    const style = options.style || getDefaultStringMap();\n    const newAttributes = {\n        allowTransparency: 'true',\n        ...attributes\n    };\n    const newStyle = {\n        backgroundColor: 'transparent',\n        border:          'none',\n        ...style\n    };\n    // @ts-ignore - no 3rd argument for container supplied to createElement\n    const frame = createElement('iframe', {\n        attributes: newAttributes,\n        style:      newStyle,\n        html:       options.html,\n        class:      options.class\n    });\n    const isIE = window.navigator.userAgent.match(/MSIE|Edge/i);\n\n    if (!frame.hasAttribute('id')) {\n        frame.setAttribute('id', uniqueID());\n    }\n\n    // @ts-ignore\n    awaitFrameLoad(frame);\n\n    if (container) {\n        const el = getElement(container);\n        el.appendChild(frame);\n    }\n\n    if (options.url || isIE) {\n        frame.setAttribute('src', options.url || 'about:blank');\n    }\n\n    // @ts-ignore\n    return frame;\n}\nexport function addEventListener(obj: HTMLElement, event: string, handler: (event: Event) => void): CancelableType { // eslint-disable-line no-shadow\n    obj.addEventListener(event, handler);\n    return {\n        cancel() {\n            obj.removeEventListener(event, handler);\n        }\n\n    };\n}\nexport function bindEvents(element: HTMLElement, eventNames: ReadonlyArray<string>, handler: (event: Event) => void): CancelableType {\n    handler = once(handler);\n\n    for (const eventName of eventNames) {\n        element.addEventListener(eventName, handler);\n    }\n\n    return {\n        cancel: once(() => {\n            for (const eventName of eventNames) {\n                element.removeEventListener(eventName, handler);\n            }\n        })\n    };\n}\nconst VENDOR_PREFIXES = [ 'webkit', 'moz', 'ms', 'o' ];\nexport function setVendorCSS(element: HTMLElement, name: string, value: string): void {\n    // @ts-ignore\n    element.style[name] = value;\n    const capitalizedName = capitalizeFirstLetter(name);\n\n    for (const prefix of VENDOR_PREFIXES) {\n        // @ts-ignore\n        element.style[`${ prefix }${ capitalizedName }`] = value;\n    }\n}\nconst ANIMATION_START_EVENTS = [ 'animationstart', 'webkitAnimationStart', 'oAnimationStart', 'MSAnimationStart' ];\nconst ANIMATION_END_EVENTS = [ 'animationend', 'webkitAnimationEnd', 'oAnimationEnd', 'MSAnimationEnd' ];\nexport function animate(element: ElementRefType, name: string, clean: (arg0: (...args: Array<any>) => any) => void, timeout = 1000): ZalgoPromise<void> {\n    // @ts-upgrade TODO - zalgo promise types\n    return new ZalgoPromise((resolve: Function, reject: Function) => {\n        const el = getElement(element);\n\n        if (!el) {\n            return resolve();\n        }\n\n        let hasStarted = false;\n        // eslint-disable-next-line prefer-const\n        let startTimeout: NodeJS.Timeout;\n        let endTimeout: NodeJS.Timeout;\n        // eslint-disable-next-line prefer-const\n        let startEvent: CancelableType;\n        // eslint-disable-next-line prefer-const\n        let endEvent: CancelableType;\n\n        function cleanUp() {\n            clearTimeout(startTimeout);\n            clearTimeout(endTimeout);\n            startEvent.cancel();\n            endEvent.cancel();\n        }\n\n        startEvent = bindEvents(el, ANIMATION_START_EVENTS, event => {\n            // @ts-ignore\n            if (event.target !== el || event.animationName !== name) {\n                return;\n            }\n\n            clearTimeout(startTimeout);\n            event.stopPropagation();\n            startEvent.cancel();\n            hasStarted = true;\n            endTimeout = setTimeout(() => {\n                cleanUp();\n                resolve();\n            }, timeout);\n        });\n        endEvent = bindEvents(el, ANIMATION_END_EVENTS, event => {\n            // @ts-ignore\n            if (event.target !== el || event.animationName !== name) {\n                return;\n            }\n\n            cleanUp();\n\n            // @ts-ignore\n            if (typeof event.animationName === 'string' && event.animationName !== name) {\n                // @ts-ignore\n                return reject(`Expected animation name to be ${ name }, found ${ event.animationName }`);\n            }\n\n            return resolve();\n        });\n        setVendorCSS(el, 'animationName', name);\n        startTimeout = setTimeout(() => {\n            if (!hasStarted) {\n                cleanUp();\n                return resolve();\n            }\n        }, 200);\n\n        if (clean) {\n            clean(cleanUp);\n        }\n    });\n}\nexport function makeElementVisible(element: HTMLElement): void {\n    element.style.setProperty('visibility', '');\n}\nexport function makeElementInvisible(element: HTMLElement): void {\n    element.style.setProperty('visibility', 'hidden', 'important');\n}\nexport function showElement(element: HTMLElement): void {\n    element.style.setProperty('display', '');\n}\nexport function hideElement(element: HTMLElement): void {\n    element.style.setProperty('display', 'none', 'important');\n}\nexport function destroyElement(element: HTMLElement): void {\n    if (element && element.parentNode) {\n        element.parentNode.removeChild(element);\n    }\n}\nexport function showAndAnimate(element: HTMLElement, name: string, clean: (arg0: (...args: Array<any>) => any) => void): ZalgoPromise<void> {\n    const animation = animate(element, name, clean);\n    showElement(element);\n    return animation;\n}\nexport function animateAndHide(element: HTMLElement, name: string, clean: (arg0: (...args: Array<any>) => any) => void): ZalgoPromise<void> {\n    return animate(element, name, clean).then(() => {\n        hideElement(element);\n    });\n}\nexport function addClass(element: HTMLElement, name: string): void {\n    element.classList.add(name);\n}\nexport function removeClass(element: HTMLElement, name: string): void {\n    element.classList.remove(name);\n}\nexport function isElementClosed(el: HTMLElement): boolean {\n    if (!el || !el.parentNode || !el.ownerDocument || !el.ownerDocument.documentElement || !el.ownerDocument.documentElement.contains(el)) {\n        return true;\n    }\n\n    return false;\n}\nexport function watchElementForClose(element: HTMLElement, handler: () => unknown): CancelableType {\n    handler = once(handler);\n    let cancelled = false;\n    const mutationObservers: MutationObserver[] = [];\n    // eslint-disable-next-line prefer-const\n    let interval: CancelableType;\n    // eslint-disable-next-line prefer-const\n    let sacrificialFrame: HTMLIFrameElement;\n    let sacrificialFrameWin: HTMLIFrameElement;\n\n    const cancel = () => {\n        cancelled = true;\n\n        for (const observer of mutationObservers) {\n            observer.disconnect();\n        }\n\n        if (interval) {\n            interval.cancel();\n        }\n\n        if (sacrificialFrameWin) {\n            // eslint-disable-next-line no-use-before-define\n            sacrificialFrameWin.removeEventListener('unload', elementClosed);\n        }\n\n        if (sacrificialFrame) {\n            destroyElement(sacrificialFrame);\n        }\n    };\n\n    const elementClosed = () => {\n        if (!cancelled) {\n            handler();\n            cancel();\n        }\n    };\n\n    if (isElementClosed(element)) {\n        elementClosed();\n        return {\n            cancel\n        };\n    }\n\n    // Strategy 1: Mutation observer\n    if (window.MutationObserver) {\n        let mutationElement = element.parentElement;\n\n        while (mutationElement) {\n            const mutationObserver = new window.MutationObserver(() => {\n                if (isElementClosed(element)) {\n                    elementClosed();\n                }\n            });\n            mutationObserver.observe(mutationElement, {\n                childList: true\n            });\n            mutationObservers.push(mutationObserver);\n            mutationElement = mutationElement.parentElement;\n        }\n    }\n\n    // Strategy 2: Sacrificial iframe\n    sacrificialFrame = document.createElement('iframe');\n    sacrificialFrame.setAttribute('name', `__detect_close_${ uniqueID() }__`);\n    sacrificialFrame.style.display = 'none';\n    // @ts-ignore\n    awaitFrameWindow(sacrificialFrame).then((frameWin: HTMLIFrameElement) => {\n        // @ts-ignore\n        sacrificialFrameWin = assertSameDomain(frameWin);\n        sacrificialFrameWin.addEventListener('unload', elementClosed);\n    });\n    element.appendChild(sacrificialFrame);\n\n    // Strategy 3: Poller\n    const check = () => {\n        if (isElementClosed(element)) {\n            elementClosed();\n        }\n    };\n\n    interval = safeInterval(check, 1000);\n    return {\n        cancel\n    };\n}\nexport function fixScripts(el: HTMLElement, doc: Document = window.document): void {\n    // @ts-ignore - querySelectorAll takes a document not element\n    for (const script of querySelectorAll('script', el)) {\n        const parentNode = script.parentNode;\n\n        if (!parentNode) {\n            continue;\n        }\n\n        const newScript = doc.createElement('script');\n        // @ts-ignore textContent can be null\n        newScript.text = script.textContent;\n        parentNode.replaceChild(newScript, script);\n    }\n}\ntype OnResizeOptions = {\n    width?: boolean;\n    height?: boolean;\n    interval?: number;\n    win?: SameDomainWindowType;\n};\nexport function onResize(el: HTMLElement, handler: (arg0: {\n    width: number;\n    height: number;\n}) => void, {\n    width = true,\n    height = true,\n    interval = 100,\n    win = window\n}: OnResizeOptions = {}): {\n    cancel: () => void;\n} {\n    let currentWidth = el.offsetWidth;\n    let currentHeight = el.offsetHeight;\n    let canceled = false;\n    handler({\n        width:  currentWidth,\n        height: currentHeight\n    });\n\n    const check = () => {\n        if (canceled || !isElementVisible(el)) {\n            return;\n        }\n\n        const newWidth = el.offsetWidth;\n        const newHeight = el.offsetHeight;\n\n        if (width && newWidth !== currentWidth || height && newHeight !== currentHeight) {\n            handler({\n                width:  newWidth,\n                height: newHeight\n            });\n        }\n\n        currentWidth = newWidth;\n        currentHeight = newHeight;\n    };\n\n    let observer: MutationObserver;\n    let timeout: CancelableType;\n    win.addEventListener('resize', check);\n\n    // @ts-ignore\n    if (typeof win.ResizeObserver !== 'undefined') {\n        // @ts-ignore\n        observer = new win.ResizeObserver(check);\n        observer.observe(el);\n        timeout = safeInterval(check, interval * 10);\n        // @ts-ignore\n    } else if (typeof win.MutationObserver !== 'undefined') {\n        // @ts-ignore\n        observer = new win.MutationObserver(check);\n        observer.observe(el, {\n            attributes:    true,\n            childList:     true,\n            subtree:       true,\n            characterData: false\n        });\n        timeout = safeInterval(check, interval * 10);\n    } else {\n        timeout = safeInterval(check, interval);\n    }\n\n    return {\n        cancel: () => {\n            canceled = true;\n            observer.disconnect();\n            window.removeEventListener('resize', check);\n            timeout.cancel();\n        }\n    };\n}\nexport function getResourceLoadTime(url: string): number | null | undefined {\n    const performance = getPerformance();\n\n    if (!performance) {\n        return;\n    }\n\n    if (typeof performance.getEntries !== 'function') {\n        return;\n    }\n\n    const entries = performance.getEntries();\n\n    for (let i = 0; i < entries.length; i++) {\n        const entry = entries[i];\n\n        if (entry && entry.name && entry.name.indexOf(url) === 0 && typeof entry.duration === 'number') {\n            return Math.floor(entry.duration);\n        }\n    }\n}\nexport function isShadowElement(element: Node): boolean {\n    while (element.parentNode) {\n        element = element.parentNode;\n    }\n\n    return element.toString() === '[object ShadowRoot]';\n}\nexport function getShadowRoot(element: Node): Node | null | undefined {\n    while (element.parentNode) {\n        element = element.parentNode;\n    }\n\n    if (isShadowElement(element)) {\n        return element;\n    }\n}\nexport function getShadowHost(element: Node): HTMLElement | null | undefined {\n    const shadowRoot = getShadowRoot(element);\n\n    // @ts-ignore\n    if (shadowRoot && shadowRoot.host) {\n        // @ts-ignore\n        return shadowRoot.host;\n    }\n}\nexport function insertShadowSlot(element: HTMLElement): HTMLElement {\n    const shadowHost = getShadowHost(element);\n\n    if (!shadowHost) {\n        throw new Error(`Element is not in shadow dom`);\n    }\n\n    const slotName = `shadow-slot-${ uniqueID() }`;\n    const slot = document.createElement('slot');\n    slot.setAttribute('name', slotName);\n    element.appendChild(slot);\n    const slotProvider = document.createElement('div');\n    slotProvider.setAttribute('slot', slotName);\n    shadowHost.appendChild(slotProvider);\n\n    if (isShadowElement(shadowHost)) {\n        return insertShadowSlot(slotProvider);\n    }\n\n    return slotProvider;\n}\nexport function preventClickFocus(el: HTMLElement): void {\n    const onFocus = (event: Event) => {\n        el.removeEventListener('focus', onFocus);\n        event.preventDefault();\n        el.blur();\n        return false;\n    };\n\n    el.addEventListener('mousedown', () => {\n        el.addEventListener('focus', onFocus);\n        setTimeout(() => {\n            el.removeEventListener('focus', onFocus);\n        }, 1);\n    });\n}\nexport function getStackTrace(): string {\n    try {\n        throw new Error('_');\n    } catch (err) {\n        return err.stack || '';\n    }\n}\n\nfunction inferCurrentScript(): HTMLScriptElement | null | undefined {\n    try {\n        const stack = getStackTrace();\n        const stackDetails = (/.*at [^(]*\\((.*):(.+):(.+)\\)$/ig).exec(stack);\n        const scriptLocation = stackDetails && stackDetails[1];\n\n        if (!scriptLocation) {\n            return;\n        }\n\n        for (const script of Array.prototype.slice.call(document.getElementsByTagName('script')).reverse()) {\n            if (script.src && script.src === scriptLocation) {\n                return script;\n            }\n        }\n    } catch (err) { // pass\n    }\n}\n\n// eslint-disable-next-line compat/compat\nlet currentScript = typeof document !== 'undefined' ? document.currentScript : null;\ntype GetCurrentScript = () => HTMLScriptElement;\n// @ts-ignore = need memo helper\nexport const getCurrentScript: GetCurrentScript = memoize(() => {\n    if (currentScript) {\n        return currentScript;\n    }\n\n    // @ts-ignore\n    currentScript = inferCurrentScript();\n\n    if (currentScript) {\n        return currentScript;\n    }\n\n    throw new Error('Can not determine current script');\n});\nconst currentUID = uniqueID();\ntype GetCurrentScriptUID = () => string;\nexport const getCurrentScriptUID: GetCurrentScriptUID = memoize(() => {\n    let script;\n\n    try {\n        script = getCurrentScript();\n    } catch (err) {\n        return currentUID;\n    }\n\n    let uid = script.getAttribute(ATTRIBUTES.UID);\n\n    if (uid && typeof uid === 'string') {\n        return uid;\n    }\n\n    uid = script.getAttribute(`${ ATTRIBUTES.UID }-auto`);\n\n    if (uid && typeof uid === 'string') {\n        return uid;\n    }\n\n    if (script.src) {\n        const {\n            src,\n            dataset\n        } = script;\n        const stringToHash = JSON.stringify({\n            src,\n            dataset\n        });\n        const hashedString = strHashStr(stringToHash);\n        const hashResult = hashedString.slice(hashedString.length - UID_HASH_LENGTH);\n        uid = `uid_${ hashResult }`;\n    } else {\n        uid = uniqueID();\n    }\n\n    script.setAttribute(`${ ATTRIBUTES.UID }-auto`, uid);\n    return uid;\n});\ntype SubmitFormOptions = {\n    url: string;\n    target: string;\n    body?: Record<string, string | boolean>;\n    method?: string;\n};\nexport function submitForm({\n    url,\n    target,\n    body,\n    method = 'post'\n}: SubmitFormOptions): void {\n    const form = document.createElement('form');\n    form.setAttribute('target', target);\n    form.setAttribute('method', method);\n    form.setAttribute('action', url);\n    form.style.display = 'none';\n\n    if (body) {\n        for (const key of Object.keys(body)) {\n            const input = document.createElement('input');\n            input.setAttribute('name', key);\n            input.setAttribute('value', body[key]?.toString());\n            form.appendChild(input);\n        }\n    }\n\n    getBody().appendChild(form);\n    form.submit();\n    getBody().removeChild(form);\n}\n","import { uniqueID, getGlobal, inlineMemoize } from './util';\nimport { isLocalStorageEnabled } from './dom';\n\ntype Getter<T> = (handler: (arg0: Record<string, any>) => T) => T;\n\nexport type Storage = {\n    getState: Getter<any>;\n    getID: () => string;\n    isStateFresh: () => boolean;\n    getSessionState: Getter<any>;\n    getSessionID: () => string;\n};\nconst DEFAULT_SESSION_STORAGE = 20 * 60 * 1000;\nexport function getStorage({\n    name,\n    lifetime = DEFAULT_SESSION_STORAGE\n}: {\n    name: string;\n    lifetime?: number;\n}): Storage {\n    return inlineMemoize(getStorage, () => {\n        const STORAGE_KEY = `__${ name }_storage__`;\n        const newStateID = uniqueID();\n        let accessedStorage: WindowLocalStorage | null; // eslint-disable-line no-undef\n\n        function getState<T>(handler: (storage: Record<string, any>) => T): T {\n            const localStorageEnabled = isLocalStorageEnabled();\n            let storage;\n\n            if (accessedStorage) {\n                storage = accessedStorage;\n            }\n\n            if (!storage && localStorageEnabled) {\n                const rawStorage = window.localStorage.getItem(STORAGE_KEY);\n\n                if (rawStorage) {\n                    storage = JSON.parse(rawStorage);\n                }\n            }\n\n            if (!storage) {\n                storage = getGlobal()[STORAGE_KEY];\n            }\n\n            if (!storage) {\n                storage = {\n                    id: newStateID\n                };\n            }\n\n            if (!storage.id) {\n                storage.id = newStateID;\n            }\n\n            accessedStorage = storage;\n            const result = handler(storage);\n\n            if (localStorageEnabled) {\n                window.localStorage.setItem(STORAGE_KEY, JSON.stringify(storage));\n            } else {\n                getGlobal()[STORAGE_KEY] = storage;\n            }\n\n            accessedStorage = null;\n            return result;\n        }\n\n        function getID(): string {\n            return getState(storage => storage.id);\n        }\n\n        function isStateFresh(): boolean {\n            return getID() === newStateID;\n        }\n\n        function getSession<T>(handler: (state: Record<string, any>) => T): T {\n            return getState(storage => {\n                let session = storage.__session__;\n                const now = Date.now();\n\n                if (session && now - session.created > lifetime) {\n                    session = null;\n                }\n\n                if (!session) {\n                    session = {\n                        guid:    uniqueID(),\n                        created: now\n                    };\n                }\n\n                storage.__session__ = session;\n                return handler(session);\n            });\n        }\n\n        function getSessionState<T>(handler: (state: Record<string, any>) => T): T {\n            return getSession(session => {\n                session.state = session.state || {};\n                return handler(session.state);\n            });\n        }\n\n        function getSessionID(): string {\n            return getSession(session => session.guid);\n        }\n\n        return {\n            getState,\n            getID,\n            isStateFresh,\n            getSessionState,\n            getSessionID\n        };\n    }, [ {\n        name,\n        lifetime\n    } ]);\n}\n","import { noop } from './util';\nimport { getStorage } from './storage';\n\nfunction getBelterExperimentStorage(): Record<string, any> {\n    return getStorage({\n        name: 'belter_experiment'\n    });\n}\n\nfunction isEventUnique(name: string): boolean {\n    return getBelterExperimentStorage().getSessionState((state: any) => {\n        state.loggedBeacons = state.loggedBeacons || [];\n\n        if (state.loggedBeacons.indexOf(name) === -1) {\n            state.loggedBeacons.push(name);\n            return true;\n        }\n\n        return false;\n    });\n}\n\ntype Payload = Record<string, (string | boolean) | null | undefined>;\nexport type Experiment = {\n    isEnabled: () => boolean;\n    isDisabled: () => boolean;\n    getTreatment: () => string;\n    log: (arg0: string, payload?: Payload) => Experiment;\n    logStart: (payload?: Payload) => Experiment;\n    logComplete: (payload?: Payload) => Experiment;\n};\n\nfunction getRandomInteger(range: number): number {\n    return Math.floor(Math.random() * range);\n}\n\nfunction getThrottlePercentile(name: string): number {\n    return getBelterExperimentStorage().getState((state: any) => {\n        state.throttlePercentiles = state.throttlePercentiles || {};\n        state.throttlePercentiles[name] = state.throttlePercentiles[name] || getRandomInteger(100);\n        return state.throttlePercentiles[name];\n    });\n}\n\nconst THROTTLE_GROUP = {\n    TEST:     'test',\n    CONTROL:  'control',\n    THROTTLE: 'throttle'\n};\ntype ExperimentOptions = {\n    name: string;\n    sample?: number;\n    logTreatment?: (arg0: {\n        name: string;\n        treatment: string;\n        payload: Payload;\n        throttle: number;\n    }) => void;\n    logCheckpoint?: (arg0: {\n        name: string;\n        treatment: string;\n        checkpoint: string;\n        payload: Payload;\n        throttle: number;\n    }) => void;\n    sticky?: boolean;\n};\nexport function experiment({\n    name,\n    sample = 50,\n    logTreatment = noop,\n    logCheckpoint = noop,\n    sticky = true\n}: ExperimentOptions): Experiment {\n    const throttle = sticky ? getThrottlePercentile(name) : getRandomInteger(100);\n    let group: string;\n\n    // @ts-ignore __TEST__ global for test env\n    if (throttle < sample && !__TEST__) {\n        group = THROTTLE_GROUP.TEST;\n    } else if (sample >= 50 || sample <= throttle && throttle < sample * 2) {\n        group = THROTTLE_GROUP.CONTROL;\n    } else {\n        group = THROTTLE_GROUP.THROTTLE;\n    }\n\n    const treatment = `${ name }_${ group }`;\n    let started = false;\n    let forced = false;\n\n    try {\n        if (window.localStorage && window.localStorage.getItem(name)) {\n            forced = true;\n        }\n    } catch (err) { // pass\n    }\n\n    const exp = {\n        isEnabled(): boolean {\n            return group === THROTTLE_GROUP.TEST || forced;\n        },\n\n        isDisabled(): boolean {\n            return group !== THROTTLE_GROUP.TEST && !forced;\n        },\n\n        getTreatment(): string {\n            return treatment;\n        },\n\n        log(checkpoint: string, payload: Payload = {}): Experiment {\n            if (!started) {\n                return exp;\n            }\n\n            if (isEventUnique(`${ treatment }_${ JSON.stringify(payload) }`)) {\n                logTreatment({\n                    name,\n                    treatment,\n                    payload,\n                    throttle\n                });\n            }\n\n            if (isEventUnique(`${ treatment }_${ checkpoint }_${ JSON.stringify(payload) }`)) {\n                logCheckpoint({\n                    name,\n                    treatment,\n                    checkpoint,\n                    payload,\n                    throttle\n                });\n            }\n\n            return exp;\n        },\n\n        logStart(payload: Payload = {}): Experiment {\n            started = true;\n            return exp.log(`start`, payload);\n        },\n\n        logComplete(payload: Payload = {}): Experiment {\n            return exp.log(`complete`, payload);\n        }\n\n    };\n    return exp;\n}\n","import { getGlobal } from './util';\n\nexport function getGlobalNameSpace<T extends Record<string, any>>({\n    name,\n    version = 'latest'\n}: {\n    name: string;\n    version?: string;\n}): {\n    get: (arg0: string, defValue?: T) => T;\n} {\n    const global = getGlobal();\n    const globalKey = `__${ name }__${ version }_global__`;\n    const namespace = global[globalKey] = global[globalKey] || {};\n    return {\n        get: (key: string, defValue?: T): T => {\n            // @ts-ignore\n            defValue = defValue || {};\n            const item = namespace[key] = namespace[key] || defValue;\n            return item;\n        }\n    };\n}\n","import { ZalgoPromise } from 'zalgo-promise';\nimport type { SameDomainWindowType } from 'cross-domain-utils';\n\ntype RequestOptionsType = {\n    url: string;\n    method?: string;\n    headers?: Record<string, string>;\n    json?: ReadonlyArray<unknown> | Record<string, any>;\n    data?: Record<string, string>;\n    body?: string;\n    win?: SameDomainWindowType;\n    timeout?: number;\n};\ntype ResponseType = {\n    status: number;\n    headers: Record<string, string>;\n    body: Record<string, any>;\n};\nconst HEADERS = {\n    CONTENT_TYPE: 'content-type',\n    ACCEPT:       'accept'\n};\nconst headerBuilders: Function[] = [];\n\nfunction parseHeaders(rawHeaders = ''): Record<string, string> {\n    const result: Record<string, string> = {};\n\n    for (const line of rawHeaders.trim().split('\\n')) {\n        const [ key, ...values ] = line.split(':');\n        result[key.toLowerCase()] = values.join(':').trim();\n    }\n\n    return result;\n}\n\nexport function request({\n    url,\n    method = 'get',\n    headers = {},\n    json,\n    data,\n    body,\n    win = window,\n    timeout = 0\n}: RequestOptionsType): ZalgoPromise<ResponseType> {\n    // ts-upgrade TODO add zalgo promise types\n    return new ZalgoPromise((resolve: Function, reject: Function) => {\n        if (json && data || json && body || data && json) {\n            throw new Error(`Only options.json or options.data or options.body should be passed`);\n        }\n\n        const normalizedHeaders: Record<string, string> = {};\n\n        for (const key of Object.keys(headers)) {\n            normalizedHeaders[key.toLowerCase()] = headers[key];\n        }\n\n        if (json) {\n            normalizedHeaders[HEADERS.CONTENT_TYPE] = normalizedHeaders[HEADERS.CONTENT_TYPE] || 'application/json';\n        } else if (data || body) {\n            normalizedHeaders[HEADERS.CONTENT_TYPE] = normalizedHeaders[HEADERS.CONTENT_TYPE] || 'application/x-www-form-urlencoded; charset=utf-8';\n        }\n\n        normalizedHeaders[HEADERS.ACCEPT] = normalizedHeaders[HEADERS.ACCEPT] || 'application/json';\n\n        for (const headerBuilder of headerBuilders) {\n            const builtHeaders = headerBuilder();\n\n            for (const key of Object.keys(builtHeaders)) {\n                normalizedHeaders[key.toLowerCase()] = builtHeaders[key];\n            }\n        }\n\n        // @ts-ignore\n        const xhr = new win.XMLHttpRequest();\n        xhr.addEventListener('load', function xhrLoad(): void {\n            // @ts-ignore no annotation for this\n            const responseHeaders = parseHeaders(this.getAllResponseHeaders());\n\n            // @ts-ignore no annotation for this\n            if (!this.status) {\n                return reject(new Error(`Request to ${ method.toLowerCase() } ${ url } failed: no response status code.`));\n            }\n\n            const contentType = responseHeaders['content-type'];\n            const isJSON = contentType && (contentType.indexOf('application/json') === 0 || contentType.indexOf('text/json') === 0);\n            // @ts-ignore no annotation for this\n            let responseBody = this.responseText;\n\n            try {\n                responseBody = JSON.parse(responseBody);\n            } catch (err) {\n                if (isJSON) {\n                    // @ts-ignore no annotation for this\n                    return reject(new Error(`Invalid json: ${ this.responseText }.`));\n                }\n            }\n\n            const res = {\n                // @ts-ignore no annotation for this\n                status:  this.status,\n                headers: responseHeaders,\n                body:    responseBody\n            };\n            return resolve(res);\n        }, false);\n        xhr.addEventListener('error', (evt: Event) => {\n            reject(new Error(`Request to ${ method.toLowerCase() } ${ url } failed: ${ evt.toString() }.`));\n        }, false);\n        xhr.open(method, url, true);\n\n        for (const key in normalizedHeaders) {\n            if (normalizedHeaders.hasOwnProperty(key)) {\n                xhr.setRequestHeader(key, normalizedHeaders[key]);\n            }\n        }\n\n        if (json) {\n            body = JSON.stringify(json);\n        } else if (data) {\n            body = Object.keys(data).map(key => {\n                return `${ encodeURIComponent(key) }=${ data ? encodeURIComponent(data[key]) : '' }`;\n            }).join('&');\n        }\n\n        xhr.timeout = timeout;\n\n        xhr.ontimeout = function xhrTimeout() {\n            reject(new Error(`Request to ${ method.toLowerCase() } ${ url } has timed out`));\n        };\n\n        xhr.send(body);\n    });\n}\nexport function addHeaderBuilder(method: () => Record<string, string>): void {\n    headerBuilders.push(method);\n}\n","// export something to force webpack to see this as an ES module\nexport const TYPES = true;\n\ndeclare let __TEST__: boolean;  // eslint-disable-line @typescript-eslint/no-unused-vars\n\nexport type JSONPrimitive = string | boolean | number;\nexport type JSONObject = {[key in string]?: JSONValue}; // eslint-disable-line no-use-before-define\nexport type JSONArray = JSONValue[]; // eslint-disable-line no-use-before-define\nexport type JSONValue = JSONPrimitive | JSONObject | JSONArray;\nexport type JSONType = JSONObject | JSONPrimitive;\nexport type CancelableType = {\n    cancel: () => void;\n};\n","import { memoize, promisify } from './util';\n\nexport function memoized(target: Record<string, any>, name: string, descriptor: Record<string, any>): void {\n    descriptor.value = memoize(descriptor.value, {\n        name,\n        thisNamespace: true\n    });\n}\nexport function promise(target: Record<string, any>, name: string, descriptor: Record<string, any>): void {\n    descriptor.value = promisify(descriptor.value, {\n        name\n    });\n}\n","export function isPerc(str: string): boolean {\n    return typeof str === 'string' && (/^[0-9]+%$/).test(str);\n}\nexport function isPx(str: string): boolean {\n    return typeof str === 'string' && (/^[0-9]+px$/).test(str);\n}\nexport function toNum(val: string | number): number {\n    if (typeof val === 'number') {\n        return val;\n    }\n\n    const match = val.match(/^([0-9]+)(px|%)$/);\n\n    if (!match) {\n        throw new Error(`Could not match css value from ${ val }`);\n    }\n\n    return parseInt(match[1], 10);\n}\nexport function toPx(val: number | string): string {\n    return `${ toNum(val) }px`;\n}\nexport function toCSS(val: number | string): string {\n    if (typeof val === 'number') {\n        return toPx(val);\n    }\n\n    return isPerc(val) ? val : toPx(val);\n}\nexport function percOf(num: number, perc: string): number {\n    // @ts-ignore - parseInt not needed as this is a number\n    return parseInt(num * toNum(perc) / 100, 10);\n}\nexport function normalizeDimension(dim: string | number, max: number): number {\n    if (typeof dim === 'number') {\n        return dim;\n    } else if (isPerc(dim)) {\n        return percOf(max, dim);\n    } else if (isPx(dim)) {\n        return toNum(dim);\n    } else {\n        throw new Error(`Can not normalize dimension: ${ dim }`);\n    }\n}\n","import { ZalgoPromise } from 'zalgo-promise';\n\nimport { noop, tryCatch, removeFromArray } from './util';\n\ntype Prom<X> = Promise<X> | ZalgoPromise<X>;\n\ntype Handler = <T, A extends ReadonlyArray<unknown>>(name: string, fn?: (...args: A) => T) => (...args: A) => T;\ntype Wrapper<T> = (arg0: {\n    expect: Handler;\n    avoid: Handler;\n    expectError: Handler;\n    error: Handler;\n    wait: () => Prom<void>;\n}) => Prom<T> | void;\n\nexport function wrapPromise<T>(method: Wrapper<T>, {\n    timeout = 5000\n}: {\n    timeout?: number;\n} = {}): ZalgoPromise<void> {\n    const expected: Array<{\n        name: string;\n        handler: Handler;\n    }> = [];\n    const promises: Array<{\n        name: string;\n        promise: ZalgoPromise<any>;\n    }> = [];\n    return new ZalgoPromise((resolve: Function, reject: Function) => {\n        const timer = setTimeout(() => {\n            if (expected.length) {\n                reject(new Error(`Expected ${ expected[0].name } to be called in ${ timeout }ms`));\n            }\n\n            if (promises.length) {\n                reject(new Error(`Expected ${ promises[0].name } promise to complete in ${ timeout }ms`));\n            }\n        }, timeout);\n\n        // @ts-ignore\n        const expect: Handler = (name, handler = noop) => {\n            const exp = {\n                name,\n                handler\n            };\n            // @ts-ignore\n            expected.push(exp);\n            // @ts-ignore\n            return function expectWrapper(...args): any {\n                // @ts-ignore\n                removeFromArray(expected, exp);\n                const {\n                    result,\n                    error\n                    // @ts-ignore no type for this\n                } = tryCatch(() => handler.call(this, ...args));\n\n                if (error) {\n                    promises.push({\n                        name,\n                        promise: ZalgoPromise.asyncReject(error)\n                    });\n                    throw error;\n                }\n\n                promises.push({\n                    name,\n                    promise: ZalgoPromise.resolve(result)\n                });\n                return result;\n            };\n        };\n\n        // @ts-ignore\n        const avoid: Handler = (name: string, fn = noop) => {\n            return function avoidWrapper(...args): any {\n                promises.push({\n                    name,\n                    promise: ZalgoPromise.asyncReject(new Error(`Expected ${ name } to not be called`))\n                });\n                // @ts-ignore\n                return fn.call(this, ...args);\n            };\n        };\n\n        // @ts-ignore\n        const expectError: Handler = (name, handler = noop) => {\n            const exp = {\n                name,\n                handler\n            };\n            // @ts-ignore\n            expected.push(exp);\n\n            return function expectErrorWrapper(...args): any {\n                // @ts-ignore\n                removeFromArray(expected, exp);\n                const {\n                    result,\n                    error\n                    // @ts-ignore\n                } = tryCatch(() => handler.call(this, ...args));\n\n                if (error) {\n                    throw error;\n                }\n\n                promises.push({\n                    name,\n                    promise: ZalgoPromise.resolve(result).then(() => {\n                        throw new Error(`Expected ${ name } to throw an error`);\n                    }, noop)\n                });\n                return result;\n            };\n        };\n\n        const wait = (): any => {\n            return ZalgoPromise.try(() => {\n                if (promises.length) {\n                    const prom = promises[0];\n                    return prom.promise.finally(() => {\n                        removeFromArray(promises, prom);\n                    }).then(wait);\n                }\n            }).then(() => {\n                if (expected.length) {\n                    return ZalgoPromise.delay(10).then(wait);\n                }\n            });\n        };\n\n        promises.push({\n            name:    'wrapPromise handler',\n            promise: ZalgoPromise.try(() => method({\n                expect,\n                avoid,\n                expectError,\n                error: avoid,\n                wait:  () => ZalgoPromise.resolve()\n            }))\n        });\n        wait().finally(() => {\n            clearTimeout(timer);\n        }).then(resolve, reject);\n    });\n}\n"],"sourceRoot":""}